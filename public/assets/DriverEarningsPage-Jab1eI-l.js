import{_ as i,a as c,b as f,c as m}from"./CardTitle.vue_vue_type_script_setup_true_lang--LHH3i02.js";import{_ as L,C as j,f as U,h as R,g as O,a as X,b as q,d as A}from"./index-CQf1Xhsn.js";import{_ as F}from"./CardDescription.vue_vue_type_script_setup_true_lang-Bq6xeI4W.js";import{_ as S}from"./Input.vue_vue_type_script_setup_true_lang-Bj6C5Fsj.js";import{_ as G,a as H}from"./CustomPagination.vue_vue_type_script_setup_true_lang-C56SBDgm.js";import{d as J,r as p,z as K,T as Q,o as W,v as Y,c as v,b as t,a,w as s,e,F as T,s as B,x as Z,f as _,i as u,t as d,k as P,m as b,j as ee,n as te,l as se}from"./index-TZd6v5Hm.js";import{_ as le}from"./Sidebar.vue_vue_type_script_setup_true_lang-Ckioauwz.js";import{L as M}from"./loader-circle-IWiEAT06.js";import{C as V}from"./circle-check-big-47wU_KPo.js";import"./index-DSgkQ9qN.js";import"./index-D4VFAAJq.js";import"./PopperContent--wvMB_Ff.js";import"./x-Dv3lmHrD.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-g-Y2GW1p.js";const ae={class:"flex flex-col md:flex-row gap-4 items-end"},oe={class:"flex flex-col"},de={class:"flex flex-col"},ne={class:"p-4 grid grid-cols-1 md:grid-cols-3 gap-6",dir:"rtl"},ue={class:"text-2xl font-bold text-primary"},re={class:"text-2xl font-bold text-green-500"},ie={class:"text-2xl font-bold text-green-500"},ce={class:"text-2xl font-bold text-green-500"},fe={class:"text-2xl font-bold text-green-500"},me={class:"text-2xl font-bold text-red-500"},_e={class:"text-2xl font-bold text-red-500"},pe={class:"space-y-4"},xe={class:"flex items-start justify-between mb-4"},ve={class:"space-y-1"},ge={class:"flex items-center gap-2"},ye={class:"font-bold text-primary"},we={class:"ml-1 capitalize"},be={class:"text-sm text-muted-foreground"},he={class:"text-sm text-muted-foreground"},ke={class:"text-sm text-muted-foreground"},Ce={class:"text-sm text-muted-foreground"},je={class:"flex flex-col items-end gap-1"},Pe={class:"font-bold text-lg"},Ve={class:"flex flex-col flex-wrap gap-4"},$e=["src"],De={dir:"ltr",class:"w-full flex flex-col items-end"},Fe={class:"font-medium"},Se={dir:"ltr",class:"w-full flex flex-col items-end"},Te={class:"font-medium"},Be={class:"text-sm text-muted-foreground"},Me={class:"text-sm text-muted-foreground"},Ie={key:0,class:"text-center py-8"},Ne={key:1,class:"flex justify-center py-8"},tt=J({__name:"DriverEarningsPage",setup(ze){const h=p([]),x=p(!1),$=p(""),r=p({}),g=p(""),y=p(""),I=Q(),w=p(1),D=p(50),N=K(()=>Math.ceil(r.value.sum_of_orders/D.value)),z=I.params.id,k=async()=>{if(!g.value||!y.value){B.warning("اختار تاريخ البداية والنهاية الأول");return}x.value=!0;try{const n=await Z.get("/admins/all/orders",{params:{from:g.value,to:y.value,page:w.value,driver:z}});r.value=n.data.stats||{},h.value=n.data.orders||[]}catch(n){$.value=n.message||"فشل في جلب الطلبات",B.error($.value)}finally{x.value=!1}},E=()=>r.value.delivery_cost*.15;W(async()=>{const n=new Date().toISOString().split("T")[0];g.value=n,y.value=n,await k()});function C(n,l){const o=new Date(n).getTime();return(new Date(l).getTime()-o)/(1e3*60)}return Y(w,async(n,l)=>{n!==l&&await k()}),(n,l)=>(_(),v(T,null,[t(le),t(e(i),{class:"m-4",dir:"rtl"},{default:s(()=>[t(e(c),null,{default:s(()=>[t(e(f),null,{default:s(()=>[...l[3]||(l[3]=[u("بحث حسب التاريخ",-1)])]),_:1}),t(e(F),null,{default:s(()=>[u("استعرض كل الطلبات بين التاريخين المحددين (صفحة "+d(w.value)+" من "+d(N.value)+")",1)]),_:1})]),_:1}),t(e(m),null,{default:s(()=>[a("div",ae,[a("div",oe,[l[4]||(l[4]=a("label",{class:"text-sm font-medium mb-1"},"من تاريخ",-1)),t(e(S),{type:"date",modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=o=>g.value=o)},null,8,["modelValue"])]),a("div",de,[l[5]||(l[5]=a("label",{class:"text-sm font-medium mb-1"},"إلى تاريخ",-1)),t(e(S),{type:"date",modelValue:y.value,"onUpdate:modelValue":l[1]||(l[1]=o=>y.value=o)},null,8,["modelValue"])]),t(e(L),{onClick:k,disabled:x.value},{default:s(()=>[x.value?(_(),P(e(M),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):b("",!0),l[6]||(l[6]=u(" بحث ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1}),a("div",ne,[t(e(i),null,{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[7]||(l[7]=[u(" المبلغ الإجمالي للطلبات ",-1)])]),_:1}),t(e(j),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",ue,d(r.value.total_price||0)+" ج.م ",1)]),_:1})]),_:1}),t(e(i),null,{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[8]||(l[8]=[u(" إجمالي تكلفة التوصيل ",-1)])]),_:1}),t(e(V),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",re,d(r.value.delivery_cost||0)+" ج.م ",1)]),_:1})]),_:1}),t(e(i),null,{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[9]||(l[9]=[u(" الأرباح من تكلفة التوصيل ",-1)])]),_:1}),t(e(j),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",ie,d(E().toFixed(2))+" ج.م ",1)]),_:1})]),_:1}),t(e(i),null,{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[10]||(l[10]=[u("إجمالي عدد الطلبات",-1)])]),_:1}),t(e(U),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",ce,d(r.value.sum_of_orders||0),1)]),_:1})]),_:1}),t(e(i),null,{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[11]||(l[11]=[u("الطلبات المكتملة",-1)])]),_:1}),t(e(V),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",fe,d(r.value.sum_of_completed_orders||0),1)]),_:1})]),_:1}),t(e(i),null,{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[12]||(l[12]=[u("الطلبات الملغاة",-1)])]),_:1}),t(e(R),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",me,d(r.value.cancelled_orders||0),1)]),_:1})]),_:1})]),t(e(i),{class:"m-4",dir:"rtl"},{default:s(()=>[t(e(c),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:s(()=>[t(e(f),{class:"text-sm font-medium"},{default:s(()=>[...l[13]||(l[13]=[u(" إجمالي تكلفة الطلبات الملغاة ",-1)])]),_:1}),t(e(V),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(m),null,{default:s(()=>[a("div",_e,d(r.value.cancelled_cost||0)+" ج.م ",1)]),_:1})]),_:1}),t(e(i),{class:"m-4"},{default:s(()=>[t(e(c),null,{default:s(()=>[t(e(f),null,{default:s(()=>[...l[14]||(l[14]=[u("الطلبات",-1)])]),_:1}),t(e(F),null,{default:s(()=>[...l[15]||(l[15]=[u(" استعرض كل الطلبات بين التاريخين المحددين ",-1)])]),_:1})]),_:1}),t(e(m),null,{default:s(()=>[a("div",pe,[(_(!0),v(T,null,ee(h.value,o=>(_(),v("div",{key:o.id,class:"border border-border rounded-lg p-4"},[a("div",xe,[a("div",ve,[a("div",ge,[a("span",ye,"#"+d(o.order_id),1),t(e(G),{class:te(e(O)(o.order_status))},{default:s(()=>[(_(),P(se(e(X)(o.order_status)),{class:"h-3 w-3"})),a("span",we,d(e(q)(o.order_status)),1)]),_:2},1032,["class"])]),a("p",be,d(o.created_at.replace("T"," ").split(".")[0]),1),a("p",he,d(C(o.created_at,o.ready_at).toFixed(2))+" تم التجهيز خلال ",1),a("p",ke,d(C(o.created_at,o.picked_up_at).toFixed(2))+" تم الاستلام خلال ",1),a("p",Ce,d(C(o.created_at,o.delivered_at).toFixed(2))+" تم التوصيل خلال ",1)]),a("div",je,[a("span",Pe," تكلفة الطلب: "+d(o.order_total_price)+" ج.م ",1),a("span",null," تكلفة التوصيل: "+d(o.order_delivery_cost)+" ج.م ",1),a("span",null," صافي الربح: "+d((o.order_delivery_cost*.15).toFixed(2))+" ج.م ",1),a("span",null," طريقة الدفع : "+d(e(A)(o.payment_method)),1)])]),a("div",Ve,[o.order_receipt?(_(),v("img",{key:0,src:"https://deliveryshop.cloud"+o.order_receipt,alt:"Receipt Image",class:"h-36 w-36 rounded-md object-cover"},null,8,$e)):b("",!0),a("div",De,[a("p",Fe,d(o.restaurant_name)+" : اسم المطعم ",1),a("p",null,d(o.restaurant_address)+" : عنوان المطعم",1)]),a("div",Se,[a("p",Te,d(o.user_name)+" : الاسم",1),a("p",Be,d(o.user_phone)+" : التليفون ",1),a("p",Me,d(o.user_address)+" : العنوان ",1)])])]))),128)),!x.value&&!h.value.length?(_(),v("div",Ie,[t(e(j),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),l[16]||(l[16]=a("p",{class:"text-muted-foreground"},"مافيش طلبات للفترة المحددة",-1))])):b("",!0),x.value?(_(),v("div",Ne,[t(e(M),{class:"h-8 w-8 animate-spin text-primary"})])):b("",!0),!x.value&&h.value.length>0?(_(),P(H,{key:2,dir:"rtl","current-page":w.value,"total-items":r.value.sum_of_orders,"items-per-page":D.value,"onUpdate:currentPage":l[2]||(l[2]=o=>w.value=o)},null,8,["current-page","total-items","items-per-page"])):b("",!0)])]),_:1})]),_:1})],64))}});export{tt as default};
