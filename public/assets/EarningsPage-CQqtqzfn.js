import{d as L,r as m,z as O,o as R,v as X,c as x,b as t,a as l,w as a,e,F as V,s as T,x as q,f as i,i as u,t as d,N as A,S as G,j as B,k as P,m as w,n as H,l as J}from"./index-TZd6v5Hm.js";import{_ as c,a as f,b as _,c as p}from"./CardTitle.vue_vue_type_script_setup_true_lang--LHH3i02.js";import{_ as K,C as $,f as Q,h as W,g as Y,a as Z,b as ee,d as te}from"./index-CQf1Xhsn.js";import{_ as N}from"./CardDescription.vue_vue_type_script_setup_true_lang-Bq6xeI4W.js";import{_ as U}from"./Input.vue_vue_type_script_setup_true_lang-Bj6C5Fsj.js";import{_ as se,a as le}from"./CustomPagination.vue_vue_type_script_setup_true_lang-C56SBDgm.js";import{_ as ae}from"./Sidebar.vue_vue_type_script_setup_true_lang-Ckioauwz.js";import{L as z}from"./loader-circle-IWiEAT06.js";import{C as D}from"./circle-check-big-47wU_KPo.js";import"./index-DSgkQ9qN.js";import"./index-D4VFAAJq.js";import"./PopperContent--wvMB_Ff.js";import"./x-Dv3lmHrD.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-g-Y2GW1p.js";const oe={class:"flex flex-col md:flex-row gap-4 items-end"},de={class:"flex flex-col"},ne={class:"flex flex-col"},ue={class:"flex flex-col"},ie=["value"],re={class:"p-4 grid grid-cols-1 md:grid-cols-3 gap-6",dir:"rtl"},me={class:"text-2xl font-bold text-primary"},ce={class:"text-2xl font-bold text-green-500"},fe={class:"text-2xl font-bold text-green-500"},_e={class:"text-2xl font-bold text-green-500"},pe={class:"text-2xl font-bold text-green-500"},xe={class:"text-2xl font-bold text-red-500"},ve={class:"text-2xl font-bold text-red-500"},ge={class:"space-y-4"},ye={class:"flex items-start justify-between mb-4"},be={class:"space-y-1"},we={class:"flex items-center gap-2"},he={class:"font-bold text-primary"},ke={class:"ml-1 capitalize"},Ce={class:"text-sm text-muted-foreground"},je={class:"text-sm text-muted-foreground"},Ve={class:"text-sm text-muted-foreground"},Pe={class:"text-sm text-muted-foreground"},$e={class:"flex flex-col items-end gap-1"},De={class:"font-bold text-lg"},Se={class:"flex flex-col flex-wrap gap-4"},Fe=["src"],Me={dir:"ltr",class:"w-full flex flex-col items-end"},Te={class:"font-medium"},Be={dir:"ltr",class:"w-full flex flex-col items-end"},Ne={class:"font-medium"},Ue={class:"text-sm text-muted-foreground"},ze={class:"text-sm text-muted-foreground"},Ee={key:0,class:"text-center py-8"},Ie={key:1,class:"flex justify-center py-8"},at=L({__name:"EarningsPage",setup(Le){const h=m([]),v=m(!1),S=m(""),r=m({}),g=m(""),y=m(""),k=m(null),b=m(1),F=m(50),M=m([]),E=O(()=>Math.ceil(r.value.sum_of_orders/F.value)),C=async()=>{if(!g.value||!y.value){T.warning("اختار تاريخ البداية والنهاية الأول");return}v.value=!0;try{const n=await q.get("/admins/orders",{params:{from:g.value,to:y.value,city:k.value,page:b.value}});r.value=n.data.stats||{},h.value=n.data.orders||[],M.value=n.data.cities,console.log(n.data)}catch(n){S.value=n.message||"فشل في جلب الطلبات",T.error(S.value)}finally{v.value=!1}},I=()=>r.value.delivery_cost*.15;R(async()=>{const n=new Date().toISOString().split("T")[0];g.value=n,y.value=n,await C()});function j(n,s){const o=new Date(n).getTime();return(new Date(s).getTime()-o)/(1e3*60)}return X(b,async(n,s)=>{n!==s&&await C()}),(n,s)=>(i(),x(V,null,[t(ae),t(e(c),{class:"m-4",dir:"rtl"},{default:a(()=>[t(e(f),null,{default:a(()=>[t(e(_),null,{default:a(()=>[...s[4]||(s[4]=[u("بحث حسب التاريخ",-1)])]),_:1}),t(e(N),null,{default:a(()=>[u("استعرض كل الطلبات بين التاريخين المحددين (صفحة "+d(b.value)+" من "+d(E.value)+")",1)]),_:1})]),_:1}),t(e(p),null,{default:a(()=>[l("div",oe,[l("div",de,[s[5]||(s[5]=l("label",{class:"text-sm font-medium mb-1"},"من تاريخ",-1)),t(e(U),{type:"date",modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=o=>g.value=o)},null,8,["modelValue"])]),l("div",ne,[s[6]||(s[6]=l("label",{class:"text-sm font-medium mb-1"},"إلى تاريخ",-1)),t(e(U),{type:"date",modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=o=>y.value=o)},null,8,["modelValue"])]),l("div",ue,[s[8]||(s[8]=l("label",{class:"text-sm font-medium mb-1"},"المدينة",-1)),A(l("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>k.value=o),class:"w-full mt-1 px-3 py-1 text-sm border border-border rounded-md"},[s[7]||(s[7]=l("option",{disabled:"",selected:"",value:null},"كل المدن",-1)),(i(!0),x(V,null,B(M.value,o=>(i(),x("option",{value:o.city_name,key:o.city_name},d(o.city_name),9,ie))),128))],512),[[G,k.value]])]),t(e(K),{onClick:C,disabled:v.value},{default:a(()=>[v.value?(i(),P(e(z),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):w("",!0),s[9]||(s[9]=u(" بحث ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1}),l("div",re,[t(e(c),null,{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[10]||(s[10]=[u(" المبلغ الإجمالي للطلبات ",-1)])]),_:1}),t(e($),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",me,d(r.value.total_price||0)+" ج.م ",1)]),_:1})]),_:1}),t(e(c),null,{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[11]||(s[11]=[u(" إجمالي تكلفة التوصيل ",-1)])]),_:1}),t(e(D),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",ce,d(r.value.delivery_cost||0)+" ج.م ",1)]),_:1})]),_:1}),t(e(c),null,{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[12]||(s[12]=[u(" الأرباح من تكلفة التوصيل ",-1)])]),_:1}),t(e($),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",fe,d(I().toFixed(2))+" ج.م ",1)]),_:1})]),_:1}),t(e(c),null,{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[13]||(s[13]=[u("إجمالي عدد الطلبات",-1)])]),_:1}),t(e(Q),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",_e,d(r.value.sum_of_orders||0),1)]),_:1})]),_:1}),t(e(c),null,{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[14]||(s[14]=[u("الطلبات المكتملة",-1)])]),_:1}),t(e(D),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",pe,d(r.value.sum_of_completed_orders||0),1)]),_:1})]),_:1}),t(e(c),null,{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[15]||(s[15]=[u("الطلبات الملغاة",-1)])]),_:1}),t(e(W),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",xe,d(r.value.cancelled_orders||0),1)]),_:1})]),_:1})]),t(e(c),{class:"m-4",dir:"rtl"},{default:a(()=>[t(e(f),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:a(()=>[t(e(_),{class:"text-sm font-medium"},{default:a(()=>[...s[16]||(s[16]=[u(" إجمالي تكلفة الطلبات الملغاة ",-1)])]),_:1}),t(e(D),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(e(p),null,{default:a(()=>[l("div",ve,d(r.value.cancelled_cost||0)+" ج.م ",1)]),_:1})]),_:1}),t(e(c),{class:"m-4"},{default:a(()=>[t(e(f),null,{default:a(()=>[t(e(_),null,{default:a(()=>[...s[17]||(s[17]=[u("الطلبات",-1)])]),_:1}),t(e(N),null,{default:a(()=>[...s[18]||(s[18]=[u(" استعرض كل الطلبات بين التاريخين المحددين ",-1)])]),_:1})]),_:1}),t(e(p),null,{default:a(()=>[l("div",ge,[(i(!0),x(V,null,B(h.value,o=>(i(),x("div",{key:o.id,class:"border border-border rounded-lg p-4"},[l("div",ye,[l("div",be,[l("div",we,[l("span",he,"#"+d(o.order_id),1),t(e(se),{class:H(e(Y)(o.order_status))},{default:a(()=>[(i(),P(J(e(Z)(o.order_status)),{class:"h-3 w-3"})),l("span",ke,d(e(ee)(o.order_status)),1)]),_:2},1032,["class"])]),l("p",Ce,d(o.created_at.replace("T"," ").split(".")[0]),1),l("p",je,d(j(o.created_at,o.ready_at).toFixed(2))+" تم التجهيز خلال ",1),l("p",Ve,d(j(o.created_at,o.picked_up_at).toFixed(2))+" تم الاستلام خلال ",1),l("p",Pe,d(j(o.created_at,o.delivered_at).toFixed(2))+" تم التوصيل خلال ",1)]),l("div",$e,[l("span",De," تكلفة الطلب: "+d(o.order_total_price)+" ج.م ",1),l("span",null," تكلفة التوصيل: "+d(o.order_delivery_cost)+" ج.م ",1),l("span",null," صافي الربح: "+d((o.order_delivery_cost*.15).toFixed(2))+" ج.م ",1),l("span",null," طريقة الدفع : "+d(e(te)(o.payment_method)),1)])]),l("div",Se,[o.order_receipt?(i(),x("img",{key:0,src:"https://deliveryshop.cloud"+o.order_receipt,alt:"Receipt Image",class:"h-36 w-36 rounded-md object-cover"},null,8,Fe)):w("",!0),l("div",Me,[l("p",Te,d(o.restaurant_name)+" : اسم المطعم ",1),l("p",null,d(o.restaurant_address)+" : عنوان المطعم",1)]),l("div",Be,[l("p",Ne,d(o.user_name)+" : الاسم",1),l("p",Ue,d(o.user_phone)+" : التليفون ",1),l("p",ze,d(o.user_address)+" : العنوان ",1)])])]))),128)),!v.value&&!h.value.length?(i(),x("div",Ee,[t(e($),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),s[19]||(s[19]=l("p",{class:"text-muted-foreground"},"مافيش طلبات للفترة المحددة",-1))])):w("",!0),v.value?(i(),x("div",Ie,[t(e(z),{class:"h-8 w-8 animate-spin text-primary"})])):w("",!0),!v.value&&h.value.length>0?(i(),P(le,{key:2,dir:"rtl","current-page":b.value,"total-items":r.value.sum_of_orders,"items-per-page":F.value,"onUpdate:currentPage":s[3]||(s[3]=o=>b.value=o)},null,8,["current-page","total-items","items-per-page"])):w("",!0)])]),_:1})]),_:1})],64))}});export{at as default};
