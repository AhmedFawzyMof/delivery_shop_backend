import{d as R,g as F,f as _,h as P,i as B,x as N,e as g,a as t,w as r,u as a,y as $,z as f,o as u,k as n,b as i,c as w,F as S,l as j,t as z,q as A,v as D}from"./index-C5NPDLxV.js";import{_ as E,a as M,b as O,c as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-CBxe4J3O.js";import{_ as H}from"./CardDescription.vue_vue_type_script_setup_true_lang-49_jE5iZ.js";import{_ as V}from"./createLucideIcon-CsQdoSwz.js";import{_ as p}from"./Input.vue_vue_type_script_setup_true_lang-CkF3edwu.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-CymdxQ0O.js";import{_ as G,a as I,b as J,c as K,d as Q}from"./SelectValue.vue_vue_type_script_setup_true_lang-B0FAWFRc.js";import{_ as W,a as X}from"./SelectLabel.vue_vue_type_script_setup_true_lang-D4v1WdiU.js";import{_ as Y}from"./Textarea.vue_vue_type_script_setup_true_lang-DZIN-sSh.js";import{L as h}from"./loader-B2BrVlWD.js";import"./index-DmxO9ILx.js";import"./useForwardPropsEmits-Dvl0W8HD.js";import"./Teleport-DG6z2lou.js";import"./Collection-YunEvKz8.js";import"./check-a5TxdJkG.js";import"./PopperContent-Dposcc7J.js";const Z={class:"min-h-screen flex items-center justify-center bg-gray-100 p-4"},ee={class:"grid gap-2"},ae={class:"grid gap-2"},te={class:"grid gap-2"},se={class:"flex items-center gap-2"},le={key:1},oe={class:"grid gap-2"},re={class:"grid gap-2"},ne={class:"grid gap-2"},ie={class:"grid gap-2"},ue={class:"grid gap-2"},de={key:0,class:"mt-2"},me=["src"],fe={key:1},pe={class:"mt-4 text-center text-sm"},Fe=R({__name:"RegisterPage",setup(ce){const y=B(),x=F(),v=_(!1),b=_([]),m=_(!1);function k(){if(m.value=!0,!navigator.geolocation){f.error("المتصفح لا يدعم تحديد الموقع"),m.value=!1;return}navigator.geolocation.getCurrentPosition(l=>{const e=l.coords.latitude.toFixed(6),o=l.coords.longitude.toFixed(6);s.value.location=`${e}, ${o}`,f.success("تم جلب موقعك بنجاح"),m.value=!1},l=>{f.error("فشل في الحصول على الموقع"),console.error(l),m.value=!1},{enableHighAccuracy:!0,timeout:1e4})}const s=_({restaurant_name:"",restaurant_city:"",address:"",phone:"",commercial_register:"",location:"",password:"",logo:null}),c=_(null);async function U(){try{const l=await $.get("/cities");b.value=l.data}catch{f.error("فشل تحميل المدن")}}function L(l){const e=l.target;if(e.files&&e.files[0]){const o=e.files[0];s.value.logo=o,c.value=URL.createObjectURL(o)}}async function q(){v.value=!0;try{const l=new FormData;l.append("restaurant_name",s.value.restaurant_name),l.append("restaurant_city",s.value.restaurant_city),l.append("address",s.value.address),l.append("phone",s.value.phone),l.append("location",s.value.location),l.append("password",s.value.password),s.value.logo&&l.append("logo",s.value.logo);const e=await $.post("/restaurants/register",l);if(e.status<200||e.status>=300)throw new Error("خطأ في إرسال بيانات التسجيل");f.success("تم تسجيل حسابك بنجاح!"),y.push("/")}catch(l){f.error(l.message||"فشل تسجيل الحساب.")}finally{v.value=!1}}function C(){y.push("/restaurant")}return P(async()=>{await x.init(),x.isAuthenticated&&y.push("/restaurant/dashboard"),U()}),N(()=>s.value.logo,(l,e)=>{c.value&&e&&URL.revokeObjectURL(c.value)}),(l,e)=>(u(),g("div",Z,[t(a(E),{class:"w-full max-w-md"},{default:r(()=>[t(a(M),{class:"text-center"},{default:r(()=>[t(a(O),{class:"text-2xl"},{default:r(()=>[...e[7]||(e[7]=[n("تسجيل حساب",-1)])]),_:1}),t(a(H),null,{default:r(()=>[...e[8]||(e[8]=[n("اعمل حساب جديد علشان تبدأ تستخدم التطبيق",-1)])]),_:1})]),_:1}),t(a(T),null,{default:r(()=>[i("form",{onSubmit:D(q,["prevent"]),class:"space-y-4"},[i("div",ee,[t(a(d),{for:"restaurant_name"},{default:r(()=>[...e[9]||(e[9]=[n("اسم المطعم",-1)])]),_:1}),t(a(p),{id:"restaurant_name",type:"text",placeholder:"Pizza place",modelValue:s.value.restaurant_name,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value.restaurant_name=o),required:""},null,8,["modelValue"])]),i("div",ae,[t(a(d),{for:"address"},{default:r(()=>[...e[10]||(e[10]=[n("العنوان",-1)])]),_:1}),t(Y,{id:"address",placeholder:" اكتب عنوان المطعم",modelValue:s.value.address,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value.address=o),required:"",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"},null,8,["modelValue"])]),i("div",te,[t(a(d),null,{default:r(()=>[...e[11]||(e[11]=[n("الإحداثيات (Location)",-1)])]),_:1}),i("div",se,[t(a(p),{type:"text",modelValue:s.value.location,"onUpdate:modelValue":e[2]||(e[2]=o=>s.value.location=o),readonly:"",placeholder:"اضغط زر تحديد الموقع",class:"flex-1"},null,8,["modelValue"]),t(a(V),{type:"button",onClick:k,disabled:m.value},{default:r(()=>[m.value?(u(),w(a(h),{key:0,class:"w-4 h-4 animate-spin"})):(u(),g("span",le,"حدد موقعي"))]),_:1},8,["disabled"])])]),i("div",oe,[t(a(d),null,{default:r(()=>[...e[12]||(e[12]=[n("كلمة المرور",-1)])]),_:1}),t(a(p),{type:"password",placeholder:"********",modelValue:s.value.password,"onUpdate:modelValue":e[3]||(e[3]=o=>s.value.password=o),required:""},null,8,["modelValue"])]),i("div",re,[t(a(d),{for:"commercial_register"},{default:r(()=>[...e[13]||(e[13]=[n("رقم السجل التجاري",-1)])]),_:1}),t(a(p),{id:"commercial_register",type:"text",placeholder:"123456789",modelValue:s.value.commercial_register,"onUpdate:modelValue":e[4]||(e[4]=o=>s.value.commercial_register=o),required:""},null,8,["modelValue"])]),i("div",ne,[t(a(d),{for:"phone"},{default:r(()=>[...e[14]||(e[14]=[n("رقم الهاتف",-1)])]),_:1}),t(a(p),{id:"phone",type:"text",placeholder:"123456789",modelValue:s.value.phone,"onUpdate:modelValue":e[5]||(e[5]=o=>s.value.phone=o),required:""},null,8,["modelValue"])]),i("div",ie,[t(a(d),{for:"city"},{default:r(()=>[...e[15]||(e[15]=[n("المدينة",-1)])]),_:1}),t(a(G),{modelValue:s.value.restaurant_city,"onUpdate:modelValue":e[6]||(e[6]=o=>s.value.restaurant_city=o),required:""},{default:r(()=>[t(a(I),{class:"w-full"},{default:r(()=>[t(a(J),{placeholder:"اختر المدينة"})]),_:1}),t(a(K),null,{default:r(()=>[t(a(W),null,{default:r(()=>[t(a(X),{class:"text-gray-400"},{default:r(()=>[...e[16]||(e[16]=[n("المدينة",-1)])]),_:1}),(u(!0),g(S,null,j(b.value,o=>(u(),w(a(Q),{key:o.city_id,value:o.city_name},{default:r(()=>[n(z(o.city_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",ue,[t(a(d),{for:"logo_image"},{default:r(()=>[...e[17]||(e[17]=[n("صورة الشعار ",-1)])]),_:1}),t(a(p),{id:"logo_image",type:"file",accept:"image/*",onChange:L,required:""}),c.value?(u(),g("div",de,[i("img",{src:c.value,alt:"معاينة صورة الرخصة",class:"max-w-full h-auto rounded-md"},null,8,me)])):A("",!0)]),t(a(V),{type:"submit",class:"w-full",disabled:v.value},{default:r(()=>[v.value?(u(),w(a(h),{key:0,class:"w-4 h-4 animate-spin"})):(u(),g("span",fe," تسجيل "))]),_:1},8,["disabled"])],32),i("div",pe,[e[19]||(e[19]=n(" عندك حساب قبل كده؟ ",-1)),t(a(V),{variant:"link",onClick:C,class:"p-0 h-auto"},{default:r(()=>[...e[18]||(e[18]=[n(" سجل دخول ",-1)])]),_:1})])]),_:1})]),_:1})]))}});export{Fe as default};
