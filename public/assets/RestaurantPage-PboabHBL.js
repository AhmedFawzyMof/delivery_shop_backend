import{d as T,r as g,s as O,c as p,m as D,a as e,b as u,e as a,B as f,C as b,F as w,j as C,T as E,t as y,w as m,v as h,x as k,f as i,k as j,i as v,o as J,n as N}from"./index-DjU-SR4D.js";import{a as K,E as Q,_ as W}from"./CustomPagination.vue_vue_type_script_setup_true_lang-CV_l09hv.js";import{_ as V}from"./createLucideIcon-CpkhF4YH.js";import{_ as Y}from"./Sidebar.vue_vue_type_script_setup_true_lang-sgM1v4lD.js";import{_ as P,a as I,b as X,c as F}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-CB1hvWUA.js";import{X as q}from"./x-CN-yFgvQ.js";import{S as M}from"./star-C6P6vriD.js";import{S as Z,F as ee}from"./search-Ci8AtlRz.js";import{E as te}from"./eye-DZXuA3u6.js";import{C as se}from"./circle-check-big-DwI6R3PE.js";import{B as oe}from"./ban-DXgZBIvL.js";import"./index-OT-Qnd2y.js";import"./Teleport-B12evmlH.js";import"./truck-CcAql6eW.js";import"./SheetTrigger.vue_vue_type_script_setup_true_lang-czE_r7b2.js";import"./PopperContent-B39yZlhX.js";import"./RovingFocusGroup-CMxlSFcM.js";import"./Collection-4N3OwyZ6.js";const re={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},le={class:"bg-card border border-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-auto"},ne={class:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card"},ae={class:"p-6 space-y-6"},ue={class:"flex items-start gap-4"},de={class:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center text-4xl"},ie=["src","alt"],pe={class:"flex-1 space-y-2"},me={class:"flex items-center gap-2 mt-2"},fe={class:"bg-muted/30 rounded-lg p-4 space-y-3"},ce={class:"grid grid-cols-2 gap-4"},ge=["value"],ve={class:"col-span-2"},be={class:"col-span-2"},xe={class:"bg-muted/30 rounded-lg p-4"},_e={class:"bg-muted/30 rounded-lg p-4"},ye={class:"text-xs text-muted-foreground"},we={class:"flex gap-3 p-6 border-t border-border bg-muted/20"},$e=T({__name:"RestaurantDetailModal",props:{restaurant:{},cities:{},isOpen:{type:Boolean},onClose:{type:Function},onEdit:{type:Function}},setup(R){const d=R,_=g(d.isOpen);O(()=>d.isOpen,c=>{_.value=c});const o=g({...d.restaurant}),$=async()=>{try{await h.put(`/restaurants/${o.value.restaurant_id}`,o.value),d.onEdit(),k.success("تم التحديث بنجاح")}catch(c){console.error(c),k.error("فشل في التحديث")}};return O(()=>d.restaurant,c=>{console.log("newVal",c),o.value={...c}}),(c,s)=>_.value?(i(),p("div",re,[e("div",le,[e("div",ne,[s[10]||(s[10]=e("h2",{class:"text-xl font-bold text-foreground"},"تفاصيل المطعم",-1)),e("button",{onClick:s[0]||(s[0]=(...t)=>d.onClose&&d.onClose(...t)),class:"p-1 hover:bg-muted rounded transition-colors"},[u(a(q),{class:"w-5 h-5 text-foreground"})])]),e("div",ae,[e("div",ue,[e("div",de,[e("img",{src:`https://deliveryshop.cloud/${o.value.logo_image}`,alt:`${o.value.restaurant_name} logo`},null,8,ie)]),e("div",pe,[f(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>o.value.restaurant_name=t),class:"w-full text-2xl font-bold text-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.restaurant_name]]),e("div",me,[(i(!0),p(w,null,C(o.value.rate||0,t=>(i(),j(a(M),{key:t,class:"w-4 h-4 fill-yellow-500 text-yellow-500"}))),128)),f(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=t=>o.value.rate=t),min:"0",max:"5",class:"w-12 text-sm text-muted-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.rate]]),s[11]||(s[11]=e("span",{class:"text-sm text-muted-foreground"},"تقييم",-1))])])]),e("div",fe,[s[16]||(s[16]=e("h3",{class:"font-semibold text-foreground"},"المعلومات الأساسية",-1)),e("div",ce,[e("div",null,[s[12]||(s[12]=e("p",{class:"text-xs text-muted-foreground"},"المدينة",-1)),f(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>o.value.restaurant_city=t),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[(i(!0),p(w,null,C(R.cities,t=>(i(),p("option",{value:t.city_name},y(t.city_name),9,ge))),256))],512),[[E,o.value.restaurant_city]])]),e("div",null,[s[13]||(s[13]=e("p",{class:"text-xs text-muted-foreground"},"السجل التجاري",-1)),f(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>o.value.commercial_register=t),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.commercial_register]])]),e("div",ve,[s[14]||(s[14]=e("p",{class:"text-xs text-muted-foreground"},"العنوان",-1)),f(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>o.value.address=t),class:"text-sm text-foreground w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.address]])]),e("div",be,[s[15]||(s[15]=e("p",{class:"text-xs text-muted-foreground"},"الموقع (الإحداثيات)",-1)),f(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>o.value.location=t),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.location]])])])]),e("div",xe,[s[18]||(s[18]=e("p",{class:"text-xs text-muted-foreground uppercase mb-2"},"الحالة",-1)),f(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>o.value.is_baned=t),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[...s[17]||(s[17]=[e("option",{value:!0},"محظور",-1),e("option",{value:!1},"نشط",-1)])],512),[[E,o.value.is_baned]])]),e("div",_e,[s[19]||(s[19]=e("label",{class:"text-xs text-muted-foreground uppercase mb-2"}," كلمة المرور ",-1)),f(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>o.value.password=t),placeholder:"يرجى تركه كما هو إذا كنت لا تريد تغييره",class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.password]])]),e("div",ye," تم إنشاء المطعم في "+y(o.value?new Date(o.value.created_at).toLocaleString():""),1)]),e("div",we,[u(a(V),{onClick:d.onClose,variant:"outline"},{default:m(()=>[...s[20]||(s[20]=[v("إغلاق",-1)])]),_:1},8,["onClick"]),u(a(V),{onClick:s[9]||(s[9]=t=>$())},{default:m(()=>[...s[21]||(s[21]=[v("حفظ التعديلات",-1)])]),_:1})])])])):D("",!0)}}),Ce={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},ke={class:"bg-card border border-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-auto"},Ue={class:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card"},Ve={class:"p-6 space-y-6"},Re={class:"flex items-start gap-4"},Se={class:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center overflow-hidden"},je=["src"],Be={key:1,class:"text-muted-foreground text-xs"},Fe={class:"flex-1 space-y-2"},Oe={class:"flex items-center gap-2 mt-2"},Ee={class:"bg-muted/30 rounded-lg p-4 space-y-3"},he={class:"grid grid-cols-2 gap-4"},Le=["value"],Te={class:"col-span-2"},De={class:"col-span-2"},Me={class:"bg-muted/30 rounded-lg p-4"},ze={class:"bg-muted/30 rounded-lg p-4"},Ne={class:"flex gap-3 p-6 border-t border-border bg-muted/20"},Pe=T({__name:"CreateRestaurantModal",props:{cities:{},isOpen:{type:Boolean},onClose:{type:Function},onCreate:{type:Function}},setup(R){const d=R,_=g(d.isOpen);O(()=>d.isOpen,s=>_.value=s);const o=g({restaurant_name:"",restaurant_city:"",logo_file:null,logo_preview:"",address:"",commercial_register:"",location:"",rate:0,is_baned:!1,password:""}),$=s=>{const t=s.target;if(t.files&&t.files[0]){const n=t.files[0];o.value.logo_file=n,o.value.logo_preview=URL.createObjectURL(n)}},c=async()=>{try{const s=new FormData;s.append("restaurant_name",o.value.restaurant_name),s.append("restaurant_city",o.value.restaurant_city),s.append("address",o.value.address),s.append("commercial_register",o.value.commercial_register),s.append("location",o.value.location),s.append("rate",o.value.rate.toString()),s.append("is_baned",o.value.is_baned.toString()),s.append("password",o.value.password),o.value.logo_file&&s.append("logo",o.value.logo_file),await h.post("/restaurants",s,{headers:{"Content-Type":"multipart/form-data"}}),k.success("تم إنشاء المطعم بنجاح"),d.onCreate(),d.onClose()}catch(s){console.error(s),k.error("فشل في إنشاء المطعم")}};return(s,t)=>_.value?(i(),p("div",Ce,[e("div",ke,[e("div",Ue,[t[10]||(t[10]=e("h2",{class:"text-xl font-bold text-foreground"},"إنشاء مطعم جديد",-1)),e("button",{onClick:t[0]||(t[0]=(...n)=>d.onClose&&d.onClose(...n)),class:"p-1 hover:bg-muted rounded transition-colors"},[u(a(q),{class:"w-5 h-5 text-foreground"})])]),e("div",Ve,[e("div",Re,[e("div",Se,[o.value.logo_preview?(i(),p("img",{key:0,src:o.value.logo_preview,class:"w-full h-full object-cover"},null,8,je)):(i(),p("span",Be,"Logo"))]),e("input",{type:"file",accept:"image/*",onChange:$,class:"text-sm mt-2"},null,32),e("div",Fe,[f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.restaurant_name=n),placeholder:"اسم المطعم",class:"w-full text-2xl font-bold text-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.restaurant_name]]),e("div",Oe,[(i(!0),p(w,null,C(o.value.rate,n=>(i(),j(a(M),{key:n,class:"w-4 h-4 fill-yellow-500 text-yellow-500"}))),128)),f(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=n=>o.value.rate=n),min:"0",max:"5",class:"w-12 text-sm text-muted-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.rate]]),t[11]||(t[11]=e("span",{class:"text-sm text-muted-foreground"},"تقييم",-1))])])]),e("div",Ee,[t[16]||(t[16]=e("h3",{class:"font-semibold text-foreground"},"المعلومات الأساسية",-1)),e("div",he,[e("div",null,[t[12]||(t[12]=e("p",{class:"text-xs text-muted-foreground"},"المدينة",-1)),f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=n=>o.value.restaurant_city=n),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[(i(!0),p(w,null,C(d.cities,n=>(i(),p("option",{value:n.city_name},y(n.city_name),9,Le))),256))],512),[[E,o.value.restaurant_city]])]),e("div",null,[t[13]||(t[13]=e("p",{class:"text-xs text-muted-foreground"},"السجل التجاري",-1)),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>o.value.commercial_register=n),class:"text-sm text-foreground w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.commercial_register]])]),e("div",Te,[t[14]||(t[14]=e("p",{class:"text-xs text-muted-foreground"},"العنوان",-1)),f(e("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>o.value.address=n),class:"text-sm text-foreground w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.address]])]),e("div",De,[t[15]||(t[15]=e("p",{class:"text-xs text-muted-foreground"},"الموقع (الإحداثيات)",-1)),f(e("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>o.value.location=n),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.location]])])])]),e("div",Me,[t[18]||(t[18]=e("p",{class:"text-xs text-muted-foreground uppercase mb-2"},"الحالة",-1)),f(e("select",{"onUpdate:modelValue":t[7]||(t[7]=n=>o.value.is_baned=n),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[...t[17]||(t[17]=[e("option",{value:!0},"محظور",-1),e("option",{value:!1},"نشط",-1)])],512),[[E,o.value.is_baned]])]),e("div",ze,[t[19]||(t[19]=e("label",{class:"text-xs text-muted-foreground uppercase mb-2"}," كلمة المرور ",-1)),f(e("input",{"onUpdate:modelValue":t[8]||(t[8]=n=>o.value.password=n),placeholder:"كلمة مرور الدخول",class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[b,o.value.password]])])]),e("div",Ne,[u(a(V),{onClick:d.onClose,variant:"outline"},{default:m(()=>[...t[20]||(t[20]=[v("إغلاق",-1)])]),_:1},8,["onClick"]),u(a(V),{onClick:t[9]||(t[9]=n=>c())},{default:m(()=>[...t[21]||(t[21]=[v("إنشاء",-1)])]),_:1})])])])):D("",!0)}}),Ie={class:"flex h-screen bg-background"},Xe={class:"w-full p-8 space-y-6"},qe={class:"flex flex-col sm:flex-row gap-4"},Ae={class:"flex-1 relative"},Ge={class:"flex gap-2"},He={class:"space-y-4"},Je={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Ke={class:"p-4 border-b border-border flex items-start justify-between"},Qe={class:"flex items-start gap-3 flex-1"},We={class:"w-12 h-12 rounded-lg bg-muted flex items-center justify-center text-2xl"},Ye=["src","alt"],Ze={class:"flex-1 min-w-0"},et={class:"font-semibold text-foreground truncate"},tt={class:"text-xs text-muted-foreground"},st={class:"p-1 hover:bg-muted rounded transition-colors"},ot={class:"p-4 space-y-3"},rt={class:"flex items-center justify-between"},lt={class:"flex items-center gap-1"},nt={class:"text-xs font-medium text-muted-foreground"},at={class:"text-xs space-y-1"},ut={class:"text-muted-foreground"},dt={class:"text-muted-foreground truncate"},it={class:"flex gap-2 pt-2"},pt={key:1,class:"col-span-full text-center py-12"},Bt=T({__name:"RestaurantPage",setup(R){const d=g(""),_=g(null),o=g(1),$=g(null),c=g(!1),s=g(new Set),t=g([]),n=g([]),L=g([]),B=g(!1),U=async()=>{try{const x=new URLSearchParams;x.append("page",o.value.toString()),d.value.trim()!==""&&x.append("search",encodeURIComponent(d.value.trim())),_.value&&x.append("city",_.value);const r=await h.get(`/restaurants?${x.toString()}`);t.value=r.data.restaurants.totalCount,L.value=r.data.restaurants.result,n.value=r.data.cities}catch{k.error("فشل في جلب المطاعم")}},z=x=>{_.value=x,o.value=1,U()},A=async(x,r)=>{try{(await h.put(`/restaurants/${x}?ban=${r}`)).data.success&&U(),k.success("تم تغيير حالة المطعم")}catch{k.error("فشل في تغيير حالة المطعم")}};function G(x,r=500){let l;return(...S)=>{clearTimeout(l),l=window.setTimeout(()=>x(...S),r)}}const H=G(U,500);return J(async()=>{await U()}),O(d,()=>{H()}),(x,r)=>(i(),p("div",Ie,[u(Y),e("div",Xe,[r[16]||(r[16]=e("div",null,[e("h1",{class:"text-3xl font-bold text-foreground"},"المطاعم"),e("p",{class:"text-muted-foreground mt-1"}," إدارة المطاعم الشريكة وتفاصيلها ")],-1)),e("div",qe,[e("div",Ae,[u(a(Z),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),f(e("input",{type:"text",placeholder:"ابحث بالاسم أو المدينة...","onUpdate:modelValue":r[0]||(r[0]=l=>d.value=l),class:"w-full pl-10 pr-4 py-2 bg-card border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[b,d.value]])]),e("div",Ge,[u(a(P),null,{default:m(()=>[u(a(I),{asChild:""},{default:m(()=>[u(a(V),{variant:"outline",size:"sm",class:"gap-2 bg-transparent"},{default:m(()=>[u(a(ee),{class:"w-4 h-4"}),v(" "+y(_.value?`المدينة: ${_.value}`:"المدينة"),1)]),_:1})]),_:1}),u(a(X),null,{default:m(()=>[u(a(F),{onClick:r[1]||(r[1]=l=>z(null))},{default:m(()=>[...r[8]||(r[8]=[v(" كل المدن ",-1)])]),_:1}),(i(!0),p(w,null,C(n.value.map(l=>l.city_name),l=>(i(),j(a(F),{key:l,onClick:S=>z(l)},{default:m(()=>[v(y(l),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),u(a(V),{onClick:r[2]||(r[2]=l=>B.value=!0)},{default:m(()=>[...r[9]||(r[9]=[v(" إنشاء مطعم ",-1)])]),_:1})]),e("div",He,[e("div",Je,[L.value.length>0?(i(!0),p(w,{key:0},C(L.value,l=>(i(),p("div",{key:l.restaurant_id,class:N(["bg-card border rounded-lg overflow-hidden transition-all",s.value.has(l.restaurant_id)?"border-red-500/50 bg-red-500/5":"border-border hover:border-primary hover:shadow-lg"])},[e("div",Ke,[e("div",Qe,[e("div",We,[e("img",{src:`https://deliveryshop.cloud/${l.logo_image}`,alt:`${l.restaurant_name} logo`},null,8,Ye)]),e("div",Ze,[e("h3",et,y(l.restaurant_name),1),e("p",tt,y(l.restaurant_city),1)])]),u(a(P),null,{default:m(()=>[u(a(I),{asChild:""},{default:m(()=>[e("button",st,[u(a(Q),{class:"w-4 h-4 text-muted-foreground"})])]),_:1}),u(a(X),{align:"end"},{default:m(()=>[u(a(F),{onClick:()=>{$.value=l,c.value=!0}},{default:m(()=>[u(a(te),{class:"w-4 h-4 mr-2"}),r[10]||(r[10]=v(" عرض التفاصيل ",-1))]),_:1},8,["onClick"]),u(a(F),{onClick:S=>A(l.restaurant_id,!l.is_baned)},{default:m(()=>[s.value.has(l.restaurant_id)?(i(),p(w,{key:0},[u(a(se),{class:"w-4 h-4 mr-2"}),r[11]||(r[11]=v(" إلغاء الحظر ",-1))],64)):(i(),p(w,{key:1},[u(a(oe),{class:"w-4 h-4 mr-2"}),r[12]||(r[12]=v(" حظر ",-1))],64))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),e("div",ot,[e("div",rt,[e("div",lt,[(i(!0),p(w,null,C(l.rate,S=>(i(),j(a(M),{key:S,class:"w-4 h-4 fill-yellow-500 text-yellow-500"}))),128))]),e("span",nt,y(l.rate)+".0 تقييم",1)]),e("div",at,[e("p",ut,[r[13]||(r[13]=e("span",{class:"font-medium text-foreground"},"رقم السجل التجاري:",-1)),v(" "+y(l.commercial_register),1)]),e("p",dt,[r[14]||(r[14]=e("span",{class:"font-medium text-foreground"},"العنوان:",-1)),v(" "+y(l.address),1)])]),e("div",it,[u(a(W),{class:N(l.is_baned?"bg-red-500/20 text-red-600":"bg-green-500/20 text-green-600")},{default:m(()=>[v(y(l.is_baned?"محظور":"نشط"),1)]),_:2},1032,["class"])])])],2))),128)):(i(),p("div",pt,[...r[15]||(r[15]=[e("p",{class:"text-muted-foreground"},"لا توجد مطاعم",-1)])]))]),u(K,{"current-page":o.value,"total-items":t.value,"items-per-page":50,"onUpdate:currentPage":r[3]||(r[3]=l=>o.value=l)},null,8,["current-page","total-items"])]),u(Pe,{cities:n.value,isOpen:B.value,onClose:r[4]||(r[4]=l=>B.value=!1),onCreate:r[5]||(r[5]=()=>{B.value=!1,U()})},null,8,["cities","isOpen"]),$.value?(i(),j($e,{key:0,restaurant:$.value,cities:n.value,"is-open":c.value,onClose:r[6]||(r[6]=l=>c.value=!1),onEdit:r[7]||(r[7]=()=>{c.value=!1,U()})},null,8,["restaurant","cities","is-open"])):D("",!0)])]))}});export{Bt as default};
