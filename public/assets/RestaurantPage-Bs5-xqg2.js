import{d as P,f as b,B as O,e as c,q as j,b as e,a as d,u as a,x as p,y as x,F as k,l as C,U as D,t as w,w as f,z as M,A as U,o as m,c as R,k as v,D as J,h as K,n as T,V as Q}from"./index-CTakD6A6.js";import{_ as W}from"./index-DaZ9IdLv.js";import{_ as S}from"./createLucideIcon-Dne6exBT.js";import{_ as Y}from"./Sidebar.vue_vue_type_script_setup_true_lang-D7ms-d9E.js";import{_ as N,a as A,b as I,c as F}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-C_KmEpXr.js";import{X as q}from"./x-CmVwNS2Q.js";import{S as z,B as Z}from"./star-UlZ0b4AH.js";import{_ as h,E as ee}from"./CustomPagination.vue_vue_type_script_setup_true_lang-BHUexTDH.js";import{S as te,F as se}from"./search-DwBCUd45.js";import{P as oe}from"./plus-DsEdje6f.js";import{E as re}from"./eye-BwDrF1bL.js";import{C as ne}from"./circle-check-big-rjFRL17W.js";import"./index-B02yCj5F.js";import"./house-B8Sz2ej8.js";import"./truck-C0S8qbak.js";import"./mail-DAB1OMWZ.js";import"./useForwardPropsEmits-Bg8EFT5z.js";import"./Teleport-DGzoDYVu.js";const le={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},ae={class:"bg-card border border-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-auto"},ue={class:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card"},de={class:"p-6 space-y-6"},ie={class:"flex items-start gap-4"},me={class:"w-16 h-16 rounded-lg bg-muted flex items-center justify-center text-4xl"},fe=["src","alt"],pe={class:"flex-1 space-y-2"},ce={class:"flex items-center gap-2 mt-2"},ge={class:"bg-muted/30 rounded-lg p-4 space-y-3"},ve={class:"grid grid-cols-2 gap-4"},be=["value"],xe={class:"col-span-2"},ye={class:"col-span-2"},_e={class:"bg-muted/30 rounded-lg p-4"},we={class:"bg-muted/30 rounded-lg p-4"},$e={class:"text-xs text-muted-foreground"},ke={class:"flex gap-3 p-6 border-t border-border bg-muted/20"},Ce=P({__name:"RestaurantDetailModal",props:{restaurant:{},cities:{},isOpen:{type:Boolean},onClose:{type:Function},onEdit:{type:Function}},setup(B){const i=B,_=b(i.isOpen);O(()=>i.isOpen,g=>{_.value=g});const o=b({...i.restaurant}),$=async()=>{try{await M.put(`/restaurants/${o.value.restaurant_id}`,o.value),i.onEdit(),U.success("تم التحديث بنجاح")}catch(g){console.error(g),U.error("فشل في التحديث")}};return O(()=>i.restaurant,g=>{console.log("newVal",g),o.value={...g}}),(g,s)=>_.value?(m(),c("div",le,[e("div",ae,[e("div",ue,[s[10]||(s[10]=e("h2",{class:"text-xl font-bold text-foreground"},"تفاصيل المطعم",-1)),e("button",{onClick:s[0]||(s[0]=(...r)=>i.onClose&&i.onClose(...r)),class:"p-1 hover:bg-muted rounded transition-colors"},[d(a(q),{class:"w-5 h-5 text-foreground"})])]),e("div",de,[e("div",ie,[e("div",me,[e("img",{src:`https://deliveryshop.webmadeeasy.online/${o.value.logo_image}`,alt:`${o.value.restaurant_name} logo`},null,8,fe)]),e("div",pe,[p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=r=>o.value.restaurant_name=r),class:"w-full text-2xl font-bold text-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.restaurant_name]]),e("div",ce,[(m(!0),c(k,null,C(o.value.rate||0,r=>(m(),R(a(z),{key:r,class:"w-4 h-4 fill-yellow-500 text-yellow-500"}))),128)),p(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=r=>o.value.rate=r),min:"0",max:"5",class:"w-12 text-sm text-muted-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.rate]]),s[11]||(s[11]=e("span",{class:"text-sm text-muted-foreground"},"تقييم",-1))])])]),e("div",ge,[s[16]||(s[16]=e("h3",{class:"font-semibold text-foreground"},"المعلومات الأساسية",-1)),e("div",ve,[e("div",null,[s[12]||(s[12]=e("p",{class:"text-xs text-muted-foreground"},"المدينة",-1)),p(e("select",{"onUpdate:modelValue":s[3]||(s[3]=r=>o.value.restaurant_city=r),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[(m(!0),c(k,null,C(B.cities,r=>(m(),c("option",{value:r.city_name},w(r.city_name),9,be))),256))],512),[[D,o.value.restaurant_city]])]),e("div",null,[s[13]||(s[13]=e("p",{class:"text-xs text-muted-foreground"},"السجل التجاري",-1)),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=r=>o.value.commercial_register=r),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.commercial_register]])]),e("div",xe,[s[14]||(s[14]=e("p",{class:"text-xs text-muted-foreground"},"العنوان",-1)),p(e("input",{"onUpdate:modelValue":s[5]||(s[5]=r=>o.value.address=r),class:"text-sm text-foreground w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.address]])]),e("div",ye,[s[15]||(s[15]=e("p",{class:"text-xs text-muted-foreground"},"الموقع (الإحداثيات)",-1)),p(e("input",{"onUpdate:modelValue":s[6]||(s[6]=r=>o.value.location=r),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.location]])])])]),e("div",_e,[s[18]||(s[18]=e("p",{class:"text-xs text-muted-foreground uppercase mb-2"},"الحالة",-1)),p(e("select",{"onUpdate:modelValue":s[7]||(s[7]=r=>o.value.is_baned=r),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[...s[17]||(s[17]=[e("option",{value:!0},"محظور",-1),e("option",{value:!1},"نشط",-1)])],512),[[D,o.value.is_baned]])]),e("div",we,[s[19]||(s[19]=e("p",{class:"text-xs text-muted-foreground uppercase mb-2"}," كلمة المرور ",-1)),p(e("input",{"onUpdate:modelValue":s[8]||(s[8]=r=>o.value.password=r),placeholder:"يرجى تركه كما هو إذا كنت لا تريد تغييره",class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.password]])]),e("div",$e," تم إنشاء المطعم في "+w(o.value?new Date(o.value.created_at).toLocaleString():""),1)]),e("div",ke,[d(a(S),{onClick:i.onClose,variant:"outline"},{default:f(()=>[...s[20]||(s[20]=[v("إغلاق",-1)])]),_:1},8,["onClick"]),d(a(S),{onClick:s[9]||(s[9]=r=>$())},{default:f(()=>[...s[21]||(s[21]=[v("حفظ التعديلات",-1)])]),_:1})])])])):j("",!0)}}),Ue={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Ve={class:"bg-card border border-border rounded-lg max-w-2xl w-full max-h-[90vh] overflow-auto"},Re={class:"flex items-center justify-between p-6 border-b border-border sticky top-0 bg-card"},Se={class:"p-6 space-y-6"},Be={class:"flex items-start gap-4"},Ee={class:"flex-1 space-y-2"},Fe={class:"flex items-center gap-2 mt-2"},Oe={class:"bg-muted/30 rounded-lg p-4 space-y-3"},je={class:"grid grid-cols-2 gap-4"},De=["value"],Me={class:"col-span-2"},Pe={class:"col-span-2"},ze={class:"bg-muted/30 rounded-lg p-4 space-y-3"},Le={class:"flex gap-3 p-6 border-t border-border bg-muted/20"},Te=P({__name:"RestaurantAddModal",props:{cities:{},isOpen:{type:Boolean},onClose:{type:Function},onEdit:{type:Function}},setup(B){const i=B,_=b(i.isOpen);O(()=>i.isOpen,r=>{_.value=r});const o=b({logo_image:"",restaurant_name:"",rate:0,restaurant_city:"",commercial_register:"",address:"",location:"",is_baned:!1,password:"",created_at:new Date().toISOString()}),$=J({get:()=>o.value.rate,set:r=>{r>5&&(r=5),r<0&&(r=0),o.value.rate=r}}),g=r=>{const t=r.target.files?.[0];t&&(o.value.logo_image=t)},s=async()=>{try{const r=new FormData;for(const t in o.value)console.log(t,o.value[t]),r.append(t,o.value[t]);await M.post("/restaurants",r),U.success("تم التحديث بنجاح"),i.onEdit()}catch(r){console.error(r),U.error("فشل في التحديث")}};return(r,t)=>_.value?(m(),c("div",Ue,[e("div",Ve,[e("div",Re,[t[10]||(t[10]=e("h2",{class:"text-xl font-bold text-foreground"},"تفاصيل المطعم",-1)),e("button",{onClick:t[0]||(t[0]=(...u)=>i.onClose&&i.onClose(...u)),class:"p-1 hover:bg-muted rounded transition-colors"},[d(a(q),{class:"w-5 h-5 text-foreground"})])]),e("div",Se,[e("div",Be,[e("div",Ee,[e("label",null,[t[11]||(t[11]=e("span",{class:"text-xs text-muted-foreground"},"الصورة",-1)),e("input",{type:"file",onChange:g,class:"text-sm"},null,32)]),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=u=>o.value.restaurant_name=u),class:"w-full text-2xl font-bold text-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.restaurant_name]]),e("div",Fe,[(m(!0),c(k,null,C(Math.round($.value),u=>(m(),R(a(z),{key:u,class:"w-4 h-4 fill-yellow-500 text-yellow-500"}))),128)),p(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=u=>$.value=u),min:"0",max:"5",class:"w-12 text-sm text-muted-foreground border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,$.value,void 0,{number:!0}]]),t[12]||(t[12]=e("span",{class:"text-sm text-muted-foreground"},"تقييم",-1))])])]),e("div",Oe,[t[17]||(t[17]=e("h3",{class:"font-semibold text-foreground"},"المعلومات الأساسية",-1)),e("div",je,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-xs text-muted-foreground"},"المدينة",-1)),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=u=>o.value.restaurant_city=u),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[(m(!0),c(k,null,C(i.cities,u=>(m(),c("option",{key:u.city_name,value:u.city_name},w(u.city_name),9,De))),128))],512),[[D,o.value.restaurant_city]])]),e("div",null,[t[14]||(t[14]=e("p",{class:"text-xs text-muted-foreground"},"السجل التجاري",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=u=>o.value.commercial_register=u),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.commercial_register]])]),e("div",Me,[t[15]||(t[15]=e("p",{class:"text-xs text-muted-foreground"},"العنوان",-1)),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=u=>o.value.address=u),class:"text-sm text-foreground w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.address]])]),e("div",Pe,[t[16]||(t[16]=e("p",{class:"text-xs text-muted-foreground"},"الموقع (الإحداثيات)",-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=u=>o.value.location=u),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.location]])])])]),e("div",ze,[t[19]||(t[19]=e("p",{class:"text-xs text-muted-foreground uppercase mb-2"},"الحالة",-1)),p(e("select",{"onUpdate:modelValue":t[7]||(t[7]=u=>o.value.is_baned=u),class:"text-sm font-medium w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},[...t[18]||(t[18]=[e("option",{value:!0},"محظور",-1),e("option",{value:!1},"نشط",-1)])],512),[[D,o.value.is_baned]]),t[20]||(t[20]=e("p",{class:"text-xs text-muted-foreground uppercase mt-4 mb-2"}," كلمة المرور ",-1)),p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=u=>o.value.password=u),class:"text-sm text-foreground font-mono w-full border-b border-border focus:outline-none focus:ring-1 focus:ring-primary"},null,512),[[x,o.value.password]])])]),e("div",Le,[d(a(S),{onClick:i.onClose,variant:"outline"},{default:f(()=>[...t[21]||(t[21]=[v("إغلاق",-1)])]),_:1},8,["onClick"]),d(a(S),{onClick:t[9]||(t[9]=u=>s())},{default:f(()=>[...t[22]||(t[22]=[v("حفظ التعديلات",-1)])]),_:1})])])])):j("",!0)}}),Ne={class:"flex h-screen bg-background"},Ae={class:"w-full p-8 space-y-6"},Ie={class:"flex flex-col sm:flex-row gap-4"},qe={class:"flex-1 relative"},Xe={class:"flex gap-2"},Ge={class:"space-y-4"},He={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Je={class:"p-4 border-b border-border flex items-start justify-between"},Ke={class:"flex items-start gap-3 flex-1"},Qe={class:"w-12 h-12 rounded-lg bg-muted flex items-center justify-center text-2xl"},We=["src","alt"],Ye={class:"flex-1 min-w-0"},Ze={class:"font-semibold text-foreground truncate"},he={class:"text-xs text-muted-foreground"},et={class:"p-1 hover:bg-muted rounded transition-colors"},tt={class:"p-4 space-y-3"},st={class:"flex items-center justify-between"},ot={class:"flex items-center gap-1"},rt={class:"text-xs font-medium text-muted-foreground"},nt={class:"text-xs space-y-1"},lt={class:"text-muted-foreground"},at={class:"text-muted-foreground truncate"},ut={class:"flex gap-2 pt-2"},dt={key:1,class:"col-span-full text-center py-12"},St=P({__name:"RestaurantPage",setup(B){const i=b(""),_=b(null),o=b(1),$=b(null),g=b(!1),s=b(!1),r=b([]),t=b([]),u=b([]),V=async()=>{try{const y=new URLSearchParams;y.append("page",o.value.toString()),i.value.trim()!==""&&y.append("search",encodeURIComponent(i.value.trim())),_.value&&y.append("city",_.value);const n=await M.get(`/restaurants?${y.toString()}`);r.value=n.data.restaurants.totalCount,u.value=n.data.restaurants.result,t.value=n.data.cities}catch{U.error("فشل في جلب المطاعم")}},L=y=>{_.value=y,o.value=1,V()},X=async(y,n)=>{try{(await M.put(`/restaurants/${y}?ban=${n}`)).data.success&&V(),U.success("تم تغيير حالة المطعم")}catch{U.error("فشل في تغيير حالة المطعم")}};function G(y,n=500){let l;return(...E)=>{clearTimeout(l),l=window.setTimeout(()=>y(...E),n)}}const H=G(V,500);return K(()=>{V()}),O(i,()=>{H()}),(y,n)=>(m(),c("div",Ne,[d(Y),e("div",Ae,[n[16]||(n[16]=e("div",null,[e("h1",{class:"text-3xl font-bold text-foreground"},"المطاعم"),e("p",{class:"text-muted-foreground mt-1"}," إدارة المطاعم الشريكة وتفاصيلها ")],-1)),e("div",Ie,[e("div",qe,[d(a(te),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),p(e("input",{type:"text",placeholder:"ابحث بالاسم أو المدينة...","onUpdate:modelValue":n[0]||(n[0]=l=>i.value=l),class:"w-full pl-10 pr-4 py-2 bg-card border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[x,i.value]])]),e("div",Xe,[d(a(N),null,{default:f(()=>[d(a(A),{asChild:""},{default:f(()=>[d(a(S),{variant:"outline",size:"sm",class:"gap-2 bg-transparent"},{default:f(()=>[d(a(se),{class:"w-4 h-4"}),v(" "+w(_.value?`المدينة: ${_.value}`:"المدينة"),1)]),_:1})]),_:1}),d(a(I),null,{default:f(()=>[d(a(F),{onClick:n[1]||(n[1]=l=>L(null))},{default:f(()=>[...n[8]||(n[8]=[v("كل المدن",-1)])]),_:1}),(m(!0),c(k,null,C(t.value.map(l=>l.city_name),l=>(m(),R(a(F),{key:l,onClick:E=>L(l)},{default:f(()=>[v(w(l),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),e("div",null,[d(a(S),{onClick:n[2]||(n[2]=l=>s.value=!0)},{default:f(()=>[d(a(oe),{class:"w-4 h-4 mr-2"}),n[9]||(n[9]=v(" اضافة مطعم ",-1))]),_:1})])]),e("div",Ge,[e("div",He,[u.value.length>0?(m(!0),c(k,{key:0},C(u.value,l=>(m(),c("div",{key:l.restaurant_id,class:T(["bg-card border rounded-lg overflow-hidden transition-all",l.is_baned?"border-red-500/50 bg-red-500/5":"border-border hover:border-primary hover:shadow-lg"])},[e("div",Je,[e("div",Ke,[e("div",Qe,[e("img",{src:`${a(Q).replace("/api","")}${l.logo_image}`,alt:`${l.restaurant_name} logo`},null,8,We)]),e("div",Ye,[e("h3",Ze,w(l.restaurant_name),1),e("p",he,w(l.restaurant_city),1)])]),d(a(N),null,{default:f(()=>[d(a(A),{asChild:""},{default:f(()=>[e("button",et,[d(a(ee),{class:"w-4 h-4 text-muted-foreground"})])]),_:1}),d(a(I),{align:"end"},{default:f(()=>[d(a(F),{onClick:()=>{$.value=l,g.value=!0}},{default:f(()=>[d(a(re),{class:"w-4 h-4 mr-2"}),n[10]||(n[10]=v(" عرض التفاصيل ",-1))]),_:1},8,["onClick"]),d(a(F),{onClick:E=>X(l.restaurant_id,!l.is_baned)},{default:f(()=>[l.is_baned?(m(),c(k,{key:0},[d(a(ne),{class:"w-4 h-4 mr-2"}),n[11]||(n[11]=v(" إلغاء الحظر ",-1))],64)):(m(),c(k,{key:1},[d(a(Z),{class:"w-4 h-4 mr-2"}),n[12]||(n[12]=v(" حظر ",-1))],64))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),e("div",tt,[e("div",st,[e("div",ot,[(m(!0),c(k,null,C(l.rate,E=>(m(),R(a(z),{key:E,class:"w-4 h-4 fill-yellow-500 text-yellow-500"}))),128))]),e("span",rt,w(l.rate)+".0 تقييم",1)]),e("div",nt,[e("p",lt,[n[13]||(n[13]=e("span",{class:"font-medium text-foreground"},"رقم السجل التجاري:",-1)),v(" "+w(l.commercial_register),1)]),e("p",at,[n[14]||(n[14]=e("span",{class:"font-medium text-foreground"},"العنوان:",-1)),v(" "+w(l.address),1)])]),e("div",ut,[d(a(W),{class:T(l.is_baned?"bg-red-500/20 text-red-600":"bg-green-500/20 text-green-600")},{default:f(()=>[v(w(l.is_baned?"محظور":"نشط"),1)]),_:2},1032,["class"])])])],2))),128)):(m(),c("div",dt,[...n[15]||(n[15]=[e("p",{class:"text-muted-foreground"},"لا توجد مطاعم",-1)])]))]),d(h,{"current-page":o.value,"total-items":r.value,"items-per-page":50,"onUpdate:currentPage":n[3]||(n[3]=l=>o.value=l)},null,8,["current-page","total-items"])]),$.value?(m(),R(Ce,{key:0,restaurant:$.value,cities:t.value,"is-open":g.value,onClose:n[4]||(n[4]=l=>g.value=!1),onEdit:n[5]||(n[5]=()=>{g.value=!1,V()})},null,8,["restaurant","cities","is-open"])):j("",!0),s.value?(m(),R(Te,{key:1,"is-open":s.value,cities:t.value,onClose:n[6]||(n[6]=l=>s.value=!1),onEdit:n[7]||(n[7]=()=>{s.value=!1,V()})},null,8,["is-open","cities"])):j("",!0)])]))}});export{St as default};
