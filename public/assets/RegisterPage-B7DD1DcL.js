import{d as R,g as F,f as p,h as P,i as B,x as N,e as _,a as t,w as o,u as a,y as $,z as f,o as u,k as i,b as n,c as w,F as S,l as j,t as z,q as A,v as D}from"./index-Cga75k13.js";import{_ as E,a as M,b as O,c as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-C8O5pVRL.js";import{_ as H}from"./CardDescription.vue_vue_type_script_setup_true_lang-CrRTQIip.js";import{_ as V}from"./createLucideIcon-vxgjZCex.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-BIJLFrhT.js";import{_ as d}from"./Label.vue_vue_type_script_setup_true_lang-jut-xyFI.js";import{_ as G,a as I,b as J,c as K,d as Q}from"./SelectValue.vue_vue_type_script_setup_true_lang-BDwqyUUU.js";import{_ as W,a as X}from"./SelectLabel.vue_vue_type_script_setup_true_lang-DYDSNWbe.js";import{_ as Y}from"./Textarea.vue_vue_type_script_setup_true_lang-B521FI3S.js";import{L as k}from"./loader-K_ZD0b5F.js";import"./index-DTINj6Za.js";import"./useForwardPropsEmits-BXA38rb4.js";import"./Teleport-DmuvEAZ3.js";import"./Collection-BKSN1ERr.js";import"./check-BbDQzkCq.js";import"./PopperContent-NJXh4jml.js";const Z={class:"min-h-screen flex items-center justify-center bg-gray-100 p-4"},ee={class:"grid gap-2"},ae={class:"grid gap-2"},te={class:"grid gap-2"},se={class:"flex items-center gap-2"},le={key:1},oe={class:"grid gap-2"},re={class:"grid gap-2"},ie={class:"grid gap-2"},ne={class:"grid gap-2"},ue={key:0,class:"mt-2"},de=["src"],me={key:1},fe={class:"mt-4 text-center text-sm"},Re=R({__name:"RegisterPage",setup(ce){const y=B(),x=F(),v=p(!1),b=p([]),m=p(!1);function h(){if(m.value=!0,!navigator.geolocation){f.error("المتصفح لا يدعم تحديد الموقع"),m.value=!1;return}navigator.geolocation.getCurrentPosition(l=>{const e=l.coords.latitude.toFixed(6),r=l.coords.longitude.toFixed(6);s.value.location=`${e}, ${r}`,f.success("تم جلب موقعك بنجاح"),m.value=!1},l=>{f.error("فشل في الحصول على الموقع"),console.error(l),m.value=!1},{enableHighAccuracy:!0,timeout:1e4})}const s=p({restaurant_name:"",restaurant_city:"",address:"",commercial_register:"",location:"",password:"",logo:null}),c=p(null);async function L(){try{const l=await $.get("/cities");b.value=l.data}catch{f.error("فشل تحميل المدن")}}function U(l){const e=l.target;if(e.files&&e.files[0]){const r=e.files[0];s.value.logo=r,c.value=URL.createObjectURL(r)}}async function C(){v.value=!0;try{const l=new FormData;l.append("restaurant_name",s.value.restaurant_name),l.append("restaurant_city",s.value.restaurant_city),l.append("address",s.value.address),l.append("commercial_register",s.value.commercial_register),l.append("location",s.value.location),l.append("password",s.value.password),s.value.logo&&l.append("logo",s.value.logo);const e=await $.post("/restaurants/register",l);if(e.status<200||e.status>=300)throw new Error("خطأ في إرسال بيانات التسجيل");f.success("تم تسجيل حسابك بنجاح!"),y.push("/")}catch(l){f.error(l.message||"فشل تسجيل الحساب.")}finally{v.value=!1}}function q(){y.push("/restaurant")}return P(async()=>{await x.init(),x.isAuthenticated&&y.push("/restaurant/dashboard"),L()}),N(()=>s.value.logo,(l,e)=>{c.value&&e&&URL.revokeObjectURL(c.value)}),(l,e)=>(u(),_("div",Z,[t(a(E),{class:"w-full max-w-md"},{default:o(()=>[t(a(M),{class:"text-center"},{default:o(()=>[t(a(O),{class:"text-2xl"},{default:o(()=>[...e[6]||(e[6]=[i("تسجيل حساب",-1)])]),_:1}),t(a(H),null,{default:o(()=>[...e[7]||(e[7]=[i("اعمل حساب جديد علشان تبدأ تستخدم التطبيق",-1)])]),_:1})]),_:1}),t(a(T),null,{default:o(()=>[n("form",{onSubmit:D(C,["prevent"]),class:"space-y-4"},[n("div",ee,[t(a(d),{for:"restaurant_name"},{default:o(()=>[...e[8]||(e[8]=[i("اسم المطعم",-1)])]),_:1}),t(a(g),{id:"restaurant_name",type:"text",placeholder:"Pizza place",modelValue:s.value.restaurant_name,"onUpdate:modelValue":e[0]||(e[0]=r=>s.value.restaurant_name=r),required:""},null,8,["modelValue"])]),n("div",ae,[t(a(d),{for:"address"},{default:o(()=>[...e[9]||(e[9]=[i("العنوان",-1)])]),_:1}),t(Y,{id:"address",placeholder:" اكتب عنوان المطعم",modelValue:s.value.address,"onUpdate:modelValue":e[1]||(e[1]=r=>s.value.address=r),required:"",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"},null,8,["modelValue"])]),n("div",te,[t(a(d),null,{default:o(()=>[...e[10]||(e[10]=[i("الإحداثيات (Location)",-1)])]),_:1}),n("div",se,[t(a(g),{type:"text",modelValue:s.value.location,"onUpdate:modelValue":e[2]||(e[2]=r=>s.value.location=r),readonly:"",placeholder:"اضغط زر تحديد الموقع",class:"flex-1"},null,8,["modelValue"]),t(a(V),{type:"button",onClick:h,disabled:m.value},{default:o(()=>[m.value?(u(),w(a(k),{key:0,class:"w-4 h-4 animate-spin"})):(u(),_("span",le,"حدد موقعي"))]),_:1},8,["disabled"])])]),n("div",oe,[t(a(d),null,{default:o(()=>[...e[11]||(e[11]=[i("كلمة المرور",-1)])]),_:1}),t(a(g),{type:"password",placeholder:"********",modelValue:s.value.password,"onUpdate:modelValue":e[3]||(e[3]=r=>s.value.password=r),required:""},null,8,["modelValue"])]),n("div",re,[t(a(d),{for:"commercial_register"},{default:o(()=>[...e[12]||(e[12]=[i("رقم السجل التجاري",-1)])]),_:1}),t(a(g),{id:"commercial_register",type:"text",placeholder:"123456789",modelValue:s.value.commercial_register,"onUpdate:modelValue":e[4]||(e[4]=r=>s.value.commercial_register=r),required:""},null,8,["modelValue"])]),n("div",ie,[t(a(d),{for:"city"},{default:o(()=>[...e[13]||(e[13]=[i("المدينة",-1)])]),_:1}),t(a(G),{modelValue:s.value.restaurant_city,"onUpdate:modelValue":e[5]||(e[5]=r=>s.value.restaurant_city=r),required:""},{default:o(()=>[t(a(I),{class:"w-full"},{default:o(()=>[t(a(J),{placeholder:"اختر المدينة"})]),_:1}),t(a(K),null,{default:o(()=>[t(a(W),null,{default:o(()=>[t(a(X),{class:"text-gray-400"},{default:o(()=>[...e[14]||(e[14]=[i("المدينة",-1)])]),_:1}),(u(!0),_(S,null,j(b.value,r=>(u(),w(a(Q),{key:r.city_id,value:r.city_name},{default:o(()=>[i(z(r.city_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",ne,[t(a(d),{for:"logo_image"},{default:o(()=>[...e[15]||(e[15]=[i("صورة الشعار ",-1)])]),_:1}),t(a(g),{id:"logo_image",type:"file",accept:"image/*",onChange:U,required:""}),c.value?(u(),_("div",ue,[n("img",{src:c.value,alt:"معاينة صورة الرخصة",class:"max-w-full h-auto rounded-md"},null,8,de)])):A("",!0)]),t(a(V),{type:"submit",class:"w-full",disabled:v.value},{default:o(()=>[v.value?(u(),w(a(k),{key:0,class:"w-4 h-4 animate-spin"})):(u(),_("span",me," تسجيل "))]),_:1},8,["disabled"])],32),n("div",fe,[e[17]||(e[17]=i(" عندك حساب قبل كده؟ ",-1)),t(a(V),{variant:"link",onClick:q,class:"p-0 h-auto"},{default:o(()=>[...e[16]||(e[16]=[i(" سجل دخول ",-1)])]),_:1})])]),_:1})]),_:1})]))}});export{Re as default};
