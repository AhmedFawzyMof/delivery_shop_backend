import{_ as y,a as w,b,c as h}from"./CardTitle.vue_vue_type_script_setup_true_lang-BJwhUuVO.js";import{_ as D}from"./CardDescription.vue_vue_type_script_setup_true_lang-C7IXrU0U.js";import{g as M}from"./Header.vue_vue_type_script_setup_true_lang-CoIIXLn6.js";import{_ as O}from"./createLucideIcon-5fTLmU3v.js";import{_ as S}from"./Input.vue_vue_type_script_setup_true_lang-Iu0oL4fu.js";import{_ as q}from"./index-ixuEUltq.js";import{d as A,f as d,D as E,h as H,B as R,e as _,a as t,b as a,w as l,u as s,F as j,A as N,z as T,o as u,k as m,t as n,c as V,q as v,l as G,n as J,p as K,C as k}from"./index-QeOVJFhL.js";import{_ as Q}from"./CustomPagination.vue_vue_type_script_setup_true_lang-BgOfRls3.js";import{L as z}from"./loader-circle-BRS3NF34.js";import{C as $}from"./clock-LI4lgUZN.js";import{C as W}from"./circle-check-big-MW3rsp_Q.js";import{T as X,P as Y}from"./truck-YMjkixy8.js";import"./useForwardPropsEmits-CTqK0wQa.js";import"./DialogTrigger-BAitYRv0.js";import"./index-DQwYqHd9.js";import"./Teleport-Yw3T0FXb.js";import"./Label.vue_vue_type_script_setup_true_lang-cIT7zMoT.js";import"./x-2wNiRnbV.js";import"./plus-kYAMcjUS.js";import"./loader-CNJrkerL.js";import"./users-Vfa-dHvC.js";import"./house-BMLp9h_D.js";const Z={class:"p-6 space-y-8",dir:"rtl"},ee={class:"flex flex-col md:flex-row gap-4 items-end"},te={class:"flex flex-col"},se={class:"flex flex-col"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"text-2xl font-bold text-primary"},oe={class:"text-2xl font-bold text-green-500"},re={class:"space-y-4"},ne={class:"flex items-start justify-between mb-4"},ue={class:"space-y-1"},de={class:"flex items-center gap-2"},ie={class:"font-bold text-primary"},me={class:"ml-1 capitalize"},ce={class:"text-sm text-muted-foreground"},fe={class:"font-bold text-lg"},pe={class:"flex flex-wrap gap-4"},_e=["src"],ge={class:"font-medium"},ve={class:"text-sm text-muted-foreground"},xe={class:"text-sm text-muted-foreground"},ye={key:0,class:"text-center py-8"},we={key:1,class:"flex justify-center py-8"},He=A({__name:"HistoryPage",setup(be){const x=d([]),i=d(!1),P=d(""),g=d({}),c=d(""),f=d(""),p=d(1),B=d(50),F=E(()=>Math.ceil(g.value.sum_of_orders/B.value)),C=async()=>{if(!c.value||!f.value){N.warning("اختار تاريخ البداية والنهاية الأول");return}i.value=!0;try{const o=await T.get(`/orders?from=${c.value}&to=${f.value}&page=${p.value}`);x.value=o.data.orders||[]}catch(o){P.value=o.message||"فشل في جلب الطلبات",N.error(P.value)}finally{i.value=!1}},I=async()=>{try{const o=await T.get(`/orders?from=${c.value}&to=${f.value}&status=true&page=${p.value}`);g.value=o.data.stats||{},console.log("Status:",o.data.stats)}catch(o){console.error("Failed to fetch stats:",o)}};H(async()=>{const o=new Date().toISOString().split("T")[0];c.value=o,f.value=o,await C(),await I()});function L(o){switch(o){case"preparing":return k($,{class:"h-4 w-4"});case"ready":return k(Y,{class:"h-4 w-4"});case"picked-up":return k(X,{class:"h-4 w-4"});default:return k($,{class:"h-4 w-4"})}}function U(o){switch(o){case"preparing":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";case"ready":return"bg-green-500/10 text-green-500 border-green-500/20";case"picked-up":return"bg-primary/10 text-primary border-primary/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}}return R(p,async(o,e)=>{o!==e&&await C()}),(o,e)=>(u(),_(j,null,[t(M),a("div",Z,[t(s(y),null,{default:l(()=>[t(s(w),null,{default:l(()=>[t(s(b),null,{default:l(()=>[...e[3]||(e[3]=[m("بحث حسب التاريخ",-1)])]),_:1}),t(s(D),null,{default:l(()=>[m("استعرض كل الطلبات بين التاريخين المحددين (صفحة "+n(p.value)+" من "+n(F.value)+")",1)]),_:1})]),_:1}),t(s(h),null,{default:l(()=>[a("div",ee,[a("div",te,[e[4]||(e[4]=a("label",{class:"text-sm font-medium mb-1"},"من تاريخ",-1)),t(s(S),{type:"date",modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=r=>c.value=r)},null,8,["modelValue"])]),a("div",se,[e[5]||(e[5]=a("label",{class:"text-sm font-medium mb-1"},"إلى تاريخ",-1)),t(s(S),{type:"date",modelValue:f.value,"onUpdate:modelValue":e[1]||(e[1]=r=>f.value=r)},null,8,["modelValue"])]),t(s(O),{onClick:C,disabled:i.value},{default:l(()=>[i.value?(u(),V(s(z),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),e[6]||(e[6]=m(" بحث ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1}),a("div",ae,[t(s(y),null,{default:l(()=>[t(s(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(s(b),{class:"text-sm font-medium"},{default:l(()=>[...e[7]||(e[7]=[m("عدد الطلبات",-1)])]),_:1}),t(s($),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(s(h),null,{default:l(()=>[a("div",le,n(g.value.sum_of_orders),1)]),_:1})]),_:1}),t(s(y),null,{default:l(()=>[t(s(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[t(s(b),{class:"text-sm font-medium"},{default:l(()=>[...e[8]||(e[8]=[m(" عدد الطلبات المكتملة ",-1)])]),_:1}),t(s(W),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),t(s(h),null,{default:l(()=>[a("div",oe,n(g.value.sum_of_completed_orders),1),e[9]||(e[9]=a("p",{class:"text-xs text-muted-foreground"},"طلبات تم تسليمها",-1))]),_:1})]),_:1})]),t(s(y),null,{default:l(()=>[t(s(w),null,{default:l(()=>[t(s(b),null,{default:l(()=>[...e[10]||(e[10]=[m("الطلبات",-1)])]),_:1}),t(s(D),null,{default:l(()=>[...e[11]||(e[11]=[m("استعرض كل الطلبات بين التاريخين المحددين",-1)])]),_:1})]),_:1}),t(s(h),null,{default:l(()=>[a("div",re,[(u(!0),_(j,null,G(x.value,r=>(u(),_("div",{key:r.id,class:"border border-border rounded-lg p-4"},[a("div",ne,[a("div",ue,[a("div",de,[a("span",ie,"#"+n(r.order_id),1),t(s(q),{class:J(U(r.order_status))},{default:l(()=>[(u(),V(K(L(r.order_status)),{class:"h-3 w-3"})),a("span",me,n(r.order_status.replace("-"," ")),1)]),_:2},1032,["class"])]),a("p",ce,n(r.created_at),1)]),a("span",fe,n(r.order_total_price)+" ج.م",1)]),a("div",pe,[r.order_receipt?(u(),_("img",{key:0,src:"https://deliveryshop.webmadeeasy.online"+r.order_receipt,alt:"Receipt Image",class:"h-36 w-36 rounded-md object-cover"},null,8,_e)):v("",!0),a("div",null,[a("p",ge,n(r.user_name)+" : الاسم",1),a("p",ve,n(r.user_phone)+" : التليفون ",1),a("p",xe,n(r.user_address)+" : العنوان ",1)])])]))),128)),!i.value&&!x.value.length?(u(),_("div",ye,[t(s($),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e[12]||(e[12]=a("p",{class:"text-muted-foreground"},"مافيش طلبات للفترة المحددة",-1))])):v("",!0),i.value?(u(),_("div",we,[t(s(z),{class:"h-8 w-8 animate-spin text-primary"})])):v("",!0),!i.value&&x.value.length>0?(u(),V(Q,{key:2,"current-page":p.value,"total-items":g.value.sum_of_orders,"items-per-page":B.value,"onUpdate:currentPage":e[2]||(e[2]=r=>p.value=r)},null,8,["current-page","total-items","items-per-page"])):v("",!0)])]),_:1})]),_:1})])],64))}});export{He as default};
