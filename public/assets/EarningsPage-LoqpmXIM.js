import{d as O,f as d,C as q,g as G,h as H,z as J,e as i,a as s,b as t,w as o,u as a,A as N,o as u,j as c,t as n,v as K,P as Q,F as T,k as U,c as S,p as x,n as W,l as X,B as C}from"./index-d-g9mRbR.js";import{_ as g,a as y,b,c as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-B_Ekwe2Y.js";import{_ as z}from"./CardDescription.vue_vue_type_script_setup_true_lang-BzARtVmM.js";import{d as Y,b as Z,_ as ee}from"./auth-BOWgCVVb.js";import{_ as A}from"./Input.vue_vue_type_script_setup_true_lang-DEP3HyZt.js";import{_ as te}from"./index-cBp-nCgD.js";import{_ as se}from"./CustomPagination.vue_vue_type_script_setup_true_lang-DpwOP1tr.js";import{_ as ae}from"./Sidebar.vue_vue_type_script_setup_true_lang-CIwOqECK.js";import{L as E}from"./loader-circle-Bkeg2r1Z.js";import{C as h}from"./clock-DZxvO7r6.js";import{C as le}from"./circle-check-big-C3-2RChK.js";import{T as oe,P as re}from"./truck-J7k0Gy93.js";import"./index-DYTBgUmH.js";import"./useForwardPropsEmits-D6-NodRW.js";import"./house-DvnnnsCD.js";import"./mail-BeP-FzBI.js";const ne={class:"flex h-screen bg-background"},ue={class:"w-full p-6 space-y-8",dir:"rtl"},de={class:"flex flex-col md:flex-row gap-4 items-end"},ie={class:"flex flex-col"},ce={class:"flex flex-col"},me={class:"flex flex-col"},fe=["value"],_e={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},pe={class:"text-2xl font-bold text-primary"},ve={class:"text-2xl font-bold text-green-500"},xe={class:"text-2xl font-bold text-green-500"},ge={class:"space-y-4"},ye={class:"flex items-start justify-between mb-4"},be={class:"space-y-1"},we={class:"flex items-center gap-2"},he={class:"font-bold text-primary"},ke={class:"ml-1 capitalize"},Ce={class:"text-sm text-muted-foreground"},Pe={class:"flex flex-col items-end gap-1"},Ve={class:"font-bold text-lg"},$e={class:"flex flex-col flex-wrap gap-4"},Se=["src"],je={dir:"ltr",class:"w-full flex flex-col items-end"},Be={class:"font-medium"},De={dir:"ltr",class:"w-full flex flex-col items-end"},Ne={class:"font-medium"},Te={class:"text-sm text-muted-foreground"},Ue={class:"text-sm text-muted-foreground"},ze={key:0,class:"text-center py-8"},Ae={key:1,class:"flex justify-center py-8"},et=O({__name:"EarningsPage",setup(Ee){const k=d([]),m=d(!1),j=d(""),f=d({}),_=d(""),p=d(""),P=d(null),V=Y(),I=H(),v=d(1),B=d(50),D=d([]),L=q(()=>Math.ceil(f.value.sum_of_orders/B.value)),$=async()=>{if(!_.value||!p.value){N.warning("اختار تاريخ البداية والنهاية الأول");return}m.value=!0;try{const r=await Z.get("/admins/orders",{params:{from:_.value,to:p.value,city:P.value,page:v.value}});f.value=r.data.stats||{},k.value=r.data.orders||[],D.value=r.data.cities,console.log(r.data)}catch(r){j.value=r.message||"فشل في جلب الطلبات",N.error(j.value)}finally{m.value=!1}},M=()=>f.value.delivery_cost*.15;G(async()=>{await V.init(),V.isAuthenticated||(V.logout(),I.push("/management"));const r=new Date().toISOString().split("T")[0];_.value=r,p.value=r,await $()});function F(r){switch(r){case"preparing":return C(h,{class:"h-4 w-4"});case"ready":return C(re,{class:"h-4 w-4"});case"picked-up":return C(oe,{class:"h-4 w-4"});default:return C(h,{class:"h-4 w-4"})}}function R(r){switch(r){case"preparing":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";case"ready":return"bg-green-500/10 text-green-500 border-green-500/20";case"picked-up":return"bg-primary/10 text-primary border-primary/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}}return J(v,async(r,e)=>{r!==e&&await $()}),(r,e)=>(u(),i("div",ne,[s(ae),t("div",ue,[s(a(g),null,{default:o(()=>[s(a(y),null,{default:o(()=>[s(a(b),null,{default:o(()=>[...e[4]||(e[4]=[c("بحث حسب التاريخ",-1)])]),_:1}),s(a(z),null,{default:o(()=>[c("استعرض كل الطلبات بين التاريخين المحددين (صفحة "+n(v.value)+" من "+n(L.value)+")",1)]),_:1})]),_:1}),s(a(w),null,{default:o(()=>[t("div",de,[t("div",ie,[e[5]||(e[5]=t("label",{class:"text-sm font-medium mb-1"},"من تاريخ",-1)),s(a(A),{type:"date",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l)},null,8,["modelValue"])]),t("div",ce,[e[6]||(e[6]=t("label",{class:"text-sm font-medium mb-1"},"إلى تاريخ",-1)),s(a(A),{type:"date",modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l)},null,8,["modelValue"])]),t("div",me,[e[8]||(e[8]=t("label",{class:"text-sm font-medium mb-1"},"المدينة",-1)),K(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>P.value=l),class:"w-full mt-1 px-3 py-1 text-sm border border-border rounded-md"},[e[7]||(e[7]=t("option",{disabled:"",selected:"",value:null},"كل المدن",-1)),(u(!0),i(T,null,U(D.value,l=>(u(),i("option",{value:l.city_name,key:l.city_name},n(l.city_name),9,fe))),128))],512),[[Q,P.value]])]),s(a(ee),{onClick:$,disabled:m.value},{default:o(()=>[m.value?(u(),S(a(E),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):x("",!0),e[9]||(e[9]=c(" بحث ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1}),t("div",_e,[s(a(g),null,{default:o(()=>[s(a(y),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[s(a(b),{class:"text-sm font-medium"},{default:o(()=>[...e[10]||(e[10]=[c("المبلغ الإجمالي للطلبات",-1)])]),_:1}),s(a(h),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(w),null,{default:o(()=>[t("div",pe,n(f.value.total_price)+" ج.م ",1)]),_:1})]),_:1}),s(a(g),null,{default:o(()=>[s(a(y),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[s(a(b),{class:"text-sm font-medium"},{default:o(()=>[...e[11]||(e[11]=[c(" إجمالي تكلفة التوصيل ",-1)])]),_:1}),s(a(le),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(w),null,{default:o(()=>[t("div",ve,n(f.value.delivery_cost)+" ج.م ",1)]),_:1})]),_:1}),s(a(g),null,{default:o(()=>[s(a(y),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[s(a(b),{class:"text-sm font-medium"},{default:o(()=>[...e[12]||(e[12]=[c(" الأرباح من تكلفة التوصيل ",-1)])]),_:1}),s(a(h),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(a(w),null,{default:o(()=>[t("div",xe,n(M())+" ج.م ",1)]),_:1})]),_:1})]),s(a(g),null,{default:o(()=>[s(a(y),null,{default:o(()=>[s(a(b),null,{default:o(()=>[...e[13]||(e[13]=[c("الطلبات",-1)])]),_:1}),s(a(z),null,{default:o(()=>[...e[14]||(e[14]=[c(" استعرض كل الطلبات بين التاريخين المحددين ",-1)])]),_:1})]),_:1}),s(a(w),null,{default:o(()=>[t("div",ge,[(u(!0),i(T,null,U(k.value,l=>(u(),i("div",{key:l.id,class:"border border-border rounded-lg p-4"},[t("div",ye,[t("div",be,[t("div",we,[t("span",he,"#"+n(l.order_id),1),s(a(te),{class:W(R(l.order_status))},{default:o(()=>[(u(),S(X(F(l.order_status)),{class:"h-3 w-3"})),t("span",ke,n(l.order_status.replace("-"," ")),1)]),_:2},1032,["class"])]),t("p",Ce,n(l.created_at),1)]),t("div",Pe,[t("span",Ve," تكلفة الطلب: "+n(l.order_total_price)+" ج.م ",1),t("span",null," تكلفة التوصيل: "+n(l.order_delivery_cost)+" ج.م ",1),t("span",null," صافي الربح: "+n(l.order_delivery_cost*.15)+" ج.م ",1)])]),t("div",$e,[l.order_receipt?(u(),i("img",{key:0,src:"https://deliveryshop.webmadeeasy.online"+l.order_receipt,alt:"Receipt Image",class:"h-36 w-36 rounded-md object-cover"},null,8,Se)):x("",!0),t("div",je,[t("p",Be,n(l.restaurant_name)+" : اسم المطعم ",1),t("p",null,n(l.restaurant_address)+" : عنوان المطعم",1)]),t("div",De,[t("p",Ne,n(l.user_name)+" : الاسم",1),t("p",Te,n(l.user_phone)+" : التليفون ",1),t("p",Ue,n(l.user_address)+" : العنوان ",1)])])]))),128)),!m.value&&!k.value.length?(u(),i("div",ze,[s(a(h),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e[15]||(e[15]=t("p",{class:"text-muted-foreground"},"مافيش طلبات للفترة المحددة",-1))])):x("",!0),m.value?(u(),i("div",Ae,[s(a(E),{class:"h-8 w-8 animate-spin text-primary"})])):x("",!0),!m.value&&k.value.length>0?(u(),S(se,{key:2,"current-page":v.value,"total-items":f.value.sum_of_orders,"items-per-page":B.value,"onUpdate:currentPage":e[3]||(e[3]=l=>v.value=l)},null,8,["current-page","total-items","items-per-page"])):x("",!0)])]),_:1})]),_:1})])]))}});export{et as default};
