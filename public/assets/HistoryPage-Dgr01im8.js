import{_ as y,a as w,b,c as h}from"./CardTitle.vue_vue_type_script_setup_true_lang--LHH3i02.js";import{_ as L,C as S,g as U,a as M}from"./index-CQf1Xhsn.js";import{_ as j}from"./CardDescription.vue_vue_type_script_setup_true_lang-Bq6xeI4W.js";import{a as O}from"./Header.vue_vue_type_script_setup_true_lang-D13dtg7P.js";import{_ as B}from"./Input.vue_vue_type_script_setup_true_lang-Bj6C5Fsj.js";import{_ as T,a as E}from"./CustomPagination.vue_vue_type_script_setup_true_lang-C56SBDgm.js";import{d as H,r as d,z as R,o as q,v as A,c as p,b as s,a,w as l,e,F as D,s as P,x as N,f as u,i as m,t as n,k,m as x,j as G,n as J,l as K}from"./index-TZd6v5Hm.js";import{L as z}from"./loader-circle-IWiEAT06.js";import{C as Q}from"./circle-check-big-47wU_KPo.js";import"./PopperContent--wvMB_Ff.js";import"./index-D4VFAAJq.js";import"./x-Dv3lmHrD.js";import"./Label.vue_vue_type_script_setup_true_lang-Bql-k3-N.js";import"./DialogTitle.vue_vue_type_script_setup_true_lang-DSSqtd07.js";import"./SelectValue.vue_vue_type_script_setup_true_lang-o64Dm6M0.js";import"./check-BuCm8Ksx.js";import"./SelectLabel.vue_vue_type_script_setup_true_lang-D9EsVPvK.js";import"./loader-DHQJhs53.js";import"./index-DSgkQ9qN.js";const W={class:"p-6 space-y-8",dir:"rtl"},X={class:"flex flex-col md:flex-row gap-4 items-end"},Y={class:"flex flex-col"},Z={class:"flex flex-col"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={class:"text-2xl font-bold text-primary"},se={class:"text-2xl font-bold text-green-500"},ae={class:"space-y-4"},le={class:"flex items-start justify-between mb-4"},oe={class:"space-y-1"},re={class:"flex items-center gap-2"},ne={class:"font-bold text-primary"},ue={class:"ml-1 capitalize"},de={class:"text-sm text-muted-foreground"},ie={class:"font-bold text-lg"},me={class:"flex flex-wrap gap-4"},ce=["src"],fe={class:"font-medium"},_e={class:"text-sm text-muted-foreground"},pe={class:"text-sm text-muted-foreground"},ve={key:0,class:"text-center py-8"},xe={key:1,class:"flex justify-center py-8"},Me=H({__name:"HistoryPage",setup(ge){const g=d([]),i=d(!1),C=d(""),v=d({}),c=d(""),f=d(""),_=d(1),V=d(50),F=R(()=>Math.ceil(v.value.sum_of_orders/V.value)),$=async()=>{if(!c.value||!f.value){P.warning("اختار تاريخ البداية والنهاية الأول");return}i.value=!0;try{const r=await N.get(`/orders?from=${c.value}&to=${f.value}&page=${_.value}`);g.value=r.data.orders||[]}catch(r){C.value=r.message||"فشل في جلب الطلبات",P.error(C.value)}finally{i.value=!1}},I=async()=>{try{const r=await N.get(`/orders?from=${c.value}&to=${f.value}&status=true&page=${_.value}`);v.value=r.data.stats||{},console.log("Status:",r.data.stats)}catch(r){console.error("Failed to fetch stats:",r)}};return q(async()=>{const r=new Date().toISOString().split("T")[0];c.value=r,f.value=r,await $(),await I()}),A(_,async(r,t)=>{r!==t&&await $()}),(r,t)=>(u(),p(D,null,[s(O),a("div",W,[s(e(y),null,{default:l(()=>[s(e(w),null,{default:l(()=>[s(e(b),null,{default:l(()=>[...t[3]||(t[3]=[m("بحث حسب التاريخ",-1)])]),_:1}),s(e(j),null,{default:l(()=>[m("استعرض كل الطلبات بين التاريخين المحددين (صفحة "+n(_.value)+" من "+n(F.value)+")",1)]),_:1})]),_:1}),s(e(h),null,{default:l(()=>[a("div",X,[a("div",Y,[t[4]||(t[4]=a("label",{class:"text-sm font-medium mb-1"},"من تاريخ",-1)),s(e(B),{type:"date",modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o)},null,8,["modelValue"])]),a("div",Z,[t[5]||(t[5]=a("label",{class:"text-sm font-medium mb-1"},"إلى تاريخ",-1)),s(e(B),{type:"date",modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=o=>f.value=o)},null,8,["modelValue"])]),s(e(L),{onClick:$,disabled:i.value},{default:l(()=>[i.value?(u(),k(e(z),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):x("",!0),t[6]||(t[6]=m(" بحث ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1}),a("div",ee,[s(e(y),null,{default:l(()=>[s(e(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(b),{class:"text-sm font-medium"},{default:l(()=>[...t[7]||(t[7]=[m("عدد الطلبات",-1)])]),_:1}),s(e(S),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(h),null,{default:l(()=>[a("div",te,n(v.value.sum_of_orders),1)]),_:1})]),_:1}),s(e(y),null,{default:l(()=>[s(e(w),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:l(()=>[s(e(b),{class:"text-sm font-medium"},{default:l(()=>[...t[8]||(t[8]=[m(" عدد الطلبات المكتملة ",-1)])]),_:1}),s(e(Q),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),s(e(h),null,{default:l(()=>[a("div",se,n(v.value.sum_of_completed_orders),1),t[9]||(t[9]=a("p",{class:"text-xs text-muted-foreground"},"طلبات تم تسليمها",-1))]),_:1})]),_:1})]),s(e(y),null,{default:l(()=>[s(e(w),null,{default:l(()=>[s(e(b),null,{default:l(()=>[...t[10]||(t[10]=[m("الطلبات",-1)])]),_:1}),s(e(j),null,{default:l(()=>[...t[11]||(t[11]=[m("استعرض كل الطلبات بين التاريخين المحددين",-1)])]),_:1})]),_:1}),s(e(h),null,{default:l(()=>[a("div",ae,[(u(!0),p(D,null,G(g.value,o=>(u(),p("div",{key:o.order_id,class:"border border-border rounded-lg p-4"},[a("div",le,[a("div",oe,[a("div",re,[a("span",ne,"#"+n(o.order_id),1),s(e(T),{class:J(e(U)(o.order_status))},{default:l(()=>[(u(),k(K(e(M)(o.order_status)),{class:"h-3 w-3"})),a("span",ue,n(o.order_status.replace("-"," ")),1)]),_:2},1032,["class"])]),a("p",de,n(o.created_at),1)]),a("span",ie,n(o.order_total_price)+" ج.م",1)]),a("div",me,[o.order_receipt?(u(),p("img",{key:0,src:"https://deliveryshop.cloud"+o.order_receipt,alt:"Receipt Image",class:"h-36 w-36 rounded-md object-cover"},null,8,ce)):x("",!0),a("div",null,[a("p",fe,n(o.user_name)+" : الاسم",1),a("p",_e,n(o.user_phone)+" : التليفون ",1),a("p",pe,n(o.user_address)+" : العنوان ",1)])])]))),128)),!i.value&&!g.value.length?(u(),p("div",ve,[s(e(S),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),t[12]||(t[12]=a("p",{class:"text-muted-foreground"},"مافيش طلبات للفترة المحددة",-1))])):x("",!0),i.value?(u(),p("div",xe,[s(e(z),{class:"h-8 w-8 animate-spin text-primary"})])):x("",!0),!i.value&&g.value.length>0?(u(),k(E,{key:2,"current-page":_.value,"total-items":v.value.sum_of_orders,"items-per-page":V.value,"onUpdate:currentPage":t[2]||(t[2]=o=>_.value=o)},null,8,["current-page","total-items","items-per-page"])):x("",!0)])]),_:1})]),_:1})])],64))}});export{Me as default};
