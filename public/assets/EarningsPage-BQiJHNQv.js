import{d as A,f as u,B as O,h as R,x as G,e as i,a,b as e,w as o,u as l,z as B,y as H,o as d,k as c,t as n,C as J,T as K,F as M,l as N,c as D,q as v,n as Q,p as W,A as C}from"./index-BG9mr9sY.js";import{_ as g,a as y,b,c as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-CixTKduS.js";import{_ as U}from"./CardDescription.vue_vue_type_script_setup_true_lang-DtBCbEzr.js";import{_ as X}from"./createLucideIcon-C7aeWmm-.js";import{_ as z}from"./Input.vue_vue_type_script_setup_true_lang-BSzucrgN.js";import{_ as Y}from"./index-moM4Hlrc.js";import{_ as Z}from"./CustomPagination.vue_vue_type_script_setup_true_lang-me83O7Ey.js";import{_ as ee}from"./Sidebar.vue_vue_type_script_setup_true_lang-C1nDLJ_-.js";import{L as E}from"./loader-circle-KVS-I9HM.js";import{C as h}from"./clock-BGmYbJVd.js";import{C as te}from"./circle-check-big-BlrwaVEk.js";import{T as se,P as ae}from"./truck-DcYqb-mC.js";import"./index-Di9DkWXL.js";import"./useForwardPropsEmits-_dF8l01g.js";import"./house-D-GpzwGF.js";import"./mail-DwJQQ0yg.js";const le={class:"flex h-screen bg-background"},oe={class:"w-full p-6 space-y-8",dir:"rtl"},ne={class:"flex flex-col md:flex-row gap-4 items-end"},re={class:"flex flex-col"},de={class:"flex flex-col"},ue={class:"flex flex-col"},ie=["value"],ce={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},me={class:"text-2xl font-bold text-primary"},fe={class:"text-2xl font-bold text-green-500"},_e={class:"text-2xl font-bold text-green-500"},pe={class:"space-y-4"},xe={class:"flex items-start justify-between mb-4"},ve={class:"space-y-1"},ge={class:"flex items-center gap-2"},ye={class:"font-bold text-primary"},be={class:"ml-1 capitalize"},we={class:"text-sm text-muted-foreground"},he={class:"text-sm text-muted-foreground"},ke={class:"text-sm text-muted-foreground"},Ce={class:"text-sm text-muted-foreground"},Ve={class:"flex flex-col items-end gap-1"},Pe={class:"font-bold text-lg"},$e={class:"flex flex-col flex-wrap gap-4"},De=["src"],Te={dir:"ltr",class:"w-full flex flex-col items-end"},Se={class:"font-medium"},je={dir:"ltr",class:"w-full flex flex-col items-end"},Be={class:"font-medium"},Me={class:"text-sm text-muted-foreground"},Ne={class:"text-sm text-muted-foreground"},Ue={key:0,class:"text-center py-8"},ze={key:1,class:"flex justify-center py-8"},at=A({__name:"EarningsPage",setup(Ee){const k=u([]),m=u(!1),T=u(""),f=u({}),_=u(""),p=u(""),V=u(null),x=u(1),S=u(50),j=u([]),I=O(()=>Math.ceil(f.value.sum_of_orders/S.value)),P=async()=>{if(!_.value||!p.value){B.warning("اختار تاريخ البداية والنهاية الأول");return}m.value=!0;try{const r=await H.get("/admins/orders",{params:{from:_.value,to:p.value,city:V.value,page:x.value}});f.value=r.data.stats||{},k.value=r.data.orders||[],j.value=r.data.cities,console.log(r.data)}catch(r){T.value=r.message||"فشل في جلب الطلبات",B.error(T.value)}finally{m.value=!1}},L=()=>f.value.delivery_cost*.15;R(async()=>{const r=new Date().toISOString().split("T")[0];_.value=r,p.value=r,await P()});function F(r){switch(r){case"preparing":return C(h,{class:"h-4 w-4"});case"ready":return C(ae,{class:"h-4 w-4"});case"picked-up":return C(se,{class:"h-4 w-4"});default:return C(h,{class:"h-4 w-4"})}}function q(r){switch(r){case"preparing":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";case"ready":return"bg-green-500/10 text-green-500 border-green-500/20";case"picked-up":return"bg-primary/10 text-primary border-primary/20";default:return"bg-gray-500/10 text-gray-500 border-gray-500/20"}}function $(r,t){const s=new Date(r).getTime();return(new Date(t).getTime()-s)/(1e3*60)}return G(x,async(r,t)=>{r!==t&&await P()}),(r,t)=>(d(),i("div",le,[a(ee),e("div",oe,[a(l(g),null,{default:o(()=>[a(l(y),null,{default:o(()=>[a(l(b),null,{default:o(()=>[...t[4]||(t[4]=[c("بحث حسب التاريخ",-1)])]),_:1}),a(l(U),null,{default:o(()=>[c("استعرض كل الطلبات بين التاريخين المحددين (صفحة "+n(x.value)+" من "+n(I.value)+")",1)]),_:1})]),_:1}),a(l(w),null,{default:o(()=>[e("div",ne,[e("div",re,[t[5]||(t[5]=e("label",{class:"text-sm font-medium mb-1"},"من تاريخ",-1)),a(l(z),{type:"date",modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s)},null,8,["modelValue"])]),e("div",de,[t[6]||(t[6]=e("label",{class:"text-sm font-medium mb-1"},"إلى تاريخ",-1)),a(l(z),{type:"date",modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=s=>p.value=s)},null,8,["modelValue"])]),e("div",ue,[t[8]||(t[8]=e("label",{class:"text-sm font-medium mb-1"},"المدينة",-1)),J(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>V.value=s),class:"w-full mt-1 px-3 py-1 text-sm border border-border rounded-md"},[t[7]||(t[7]=e("option",{disabled:"",selected:"",value:null},"كل المدن",-1)),(d(!0),i(M,null,N(j.value,s=>(d(),i("option",{value:s.city_name,key:s.city_name},n(s.city_name),9,ie))),128))],512),[[K,V.value]])]),a(l(X),{onClick:P,disabled:m.value},{default:o(()=>[m.value?(d(),D(l(E),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):v("",!0),t[9]||(t[9]=c(" بحث ",-1))]),_:1},8,["disabled"])])]),_:1})]),_:1}),e("div",ce,[a(l(g),null,{default:o(()=>[a(l(y),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[a(l(b),{class:"text-sm font-medium"},{default:o(()=>[...t[10]||(t[10]=[c("المبلغ الإجمالي للطلبات",-1)])]),_:1}),a(l(h),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(l(w),null,{default:o(()=>[e("div",me,n(f.value.total_price)+" ج.م ",1)]),_:1})]),_:1}),a(l(g),null,{default:o(()=>[a(l(y),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[a(l(b),{class:"text-sm font-medium"},{default:o(()=>[...t[11]||(t[11]=[c(" إجمالي تكلفة التوصيل ",-1)])]),_:1}),a(l(te),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(l(w),null,{default:o(()=>[e("div",fe,n(f.value.delivery_cost)+" ج.م ",1)]),_:1})]),_:1}),a(l(g),null,{default:o(()=>[a(l(y),{class:"flex flex-row items-center justify-between space-y-0 pb-2"},{default:o(()=>[a(l(b),{class:"text-sm font-medium"},{default:o(()=>[...t[12]||(t[12]=[c(" الأرباح من تكلفة التوصيل ",-1)])]),_:1}),a(l(h),{class:"h-4 w-4 text-muted-foreground"})]),_:1}),a(l(w),null,{default:o(()=>[e("div",_e,n(L())+" ج.م ",1)]),_:1})]),_:1})]),a(l(g),null,{default:o(()=>[a(l(y),null,{default:o(()=>[a(l(b),null,{default:o(()=>[...t[13]||(t[13]=[c("الطلبات",-1)])]),_:1}),a(l(U),null,{default:o(()=>[...t[14]||(t[14]=[c(" استعرض كل الطلبات بين التاريخين المحددين ",-1)])]),_:1})]),_:1}),a(l(w),null,{default:o(()=>[e("div",pe,[(d(!0),i(M,null,N(k.value,s=>(d(),i("div",{key:s.id,class:"border border-border rounded-lg p-4"},[e("div",xe,[e("div",ve,[e("div",ge,[e("span",ye,"#"+n(s.order_id),1),a(l(Y),{class:Q(q(s.order_status))},{default:o(()=>[(d(),D(W(F(s.order_status)),{class:"h-3 w-3"})),e("span",be,n(s.order_status.replace("-"," ")),1)]),_:2},1032,["class"])]),e("p",we,n(s.created_at),1),e("p",he,n($(s.created_at,s.ready_at))+" تم التجهيز خلال ",1),e("p",ke,n($(s.created_at,s.picked_up_at))+" تم الاستلام خلال ",1),e("p",Ce,n($(s.created_at,s.delivered_at))+" تم التوصيل خلال ",1)]),e("div",Ve,[e("span",Pe," تكلفة الطلب: "+n(s.order_total_price)+" ج.م ",1),e("span",null," تكلفة التوصيل: "+n(s.order_delivery_cost)+" ج.م ",1),e("span",null," صافي الربح: "+n(s.order_delivery_cost*.15)+" ج.م ",1)])]),e("div",$e,[s.order_receipt?(d(),i("img",{key:0,src:"https://deliveryshop.cloud"+s.order_receipt,alt:"Receipt Image",class:"h-36 w-36 rounded-md object-cover"},null,8,De)):v("",!0),e("div",Te,[e("p",Se,n(s.restaurant_name)+" : اسم المطعم ",1),e("p",null,n(s.restaurant_address)+" : عنوان المطعم",1)]),e("div",je,[e("p",Be,n(s.user_name)+" : الاسم",1),e("p",Me,n(s.user_phone)+" : التليفون ",1),e("p",Ne,n(s.user_address)+" : العنوان ",1)])])]))),128)),!m.value&&!k.value.length?(d(),i("div",Ue,[a(l(h),{class:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),t[15]||(t[15]=e("p",{class:"text-muted-foreground"},"مافيش طلبات للفترة المحددة",-1))])):v("",!0),m.value?(d(),i("div",ze,[a(l(E),{class:"h-8 w-8 animate-spin text-primary"})])):v("",!0),!m.value&&k.value.length>0?(d(),D(Z,{key:2,"current-page":x.value,"total-items":f.value.sum_of_orders,"items-per-page":S.value,"onUpdate:currentPage":t[3]||(t[3]=s=>x.value=s)},null,8,["current-page","total-items","items-per-page"])):v("",!0)])]),_:1})]),_:1})])]))}});export{at as default};
