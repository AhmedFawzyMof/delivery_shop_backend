import{d as K,r as y,M as O,o as Q,c as r,b as t,a as _,k as m,m as N,e as a,w as e,F as b,x as k,f as s,i,j as w,t as v}from"./index-TZd6v5Hm.js";import{_ as R}from"./Sidebar.vue_vue_type_script_setup_true_lang-Ckioauwz.js";import{_ as $}from"./index-CQf1Xhsn.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-Bj6C5Fsj.js";import{_ as U,a as E,b as S,c as F,d as M}from"./SelectValue.vue_vue_type_script_setup_true_lang-o64Dm6M0.js";import{_ as P,b as j,a as A,c as D}from"./CardTitle.vue_vue_type_script_setup_true_lang--LHH3i02.js";import{_ as W,a as X,b as I,c as V,d as Y,e as C}from"./TableHeader.vue_vue_type_script_setup_true_lang-DLlrgTms.js";import{h as L}from"./hasPermission-zJzLI1JE.js";import"./x-Dv3lmHrD.js";import"./index-D4VFAAJq.js";import"./PopperContent--wvMB_Ff.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-g-Y2GW1p.js";import"./index-DSgkQ9qN.js";import"./check-BuCm8Ksx.js";const Z={dir:"rtl",class:"p-4"},aa={class:"grid grid-cols-2 gap-4"},la={key:1},ea={key:1},ta={key:0,class:"flex gap-2"},na={key:1,class:"flex gap-2"},$a=K({__name:"CityPage",setup(sa){const x=y([]),p=y([]),B=O(),o=y({city_name:"",branch_id:""}),f=y(null),c=y({city_name:"",branch_id:""}),g=async()=>{const u=await k.get("/cities");x.value=u.data},T=async()=>{const u=await k.get("/branches");p.value=u.data.branches},q=async()=>{!o.value.city_name||!o.value.branch_id||(await k.post("/cities",o.value),o.value={city_name:"",branch_id:""},g())},z=u=>{f.value=u.city_id,c.value={city_name:u.city_name,branch_id:u.branch_id}},G=()=>{f.value=null},H=async u=>{await k.put(`/cities/${u}`,c.value),f.value=null,g()},J=u=>{const l=p.value.find(n=>n.branch_id===u);return l?l.branch_name:"—"};return Q(()=>{g(),T()}),(u,l)=>(s(),r(b,null,[t(R),_("div",Z,[l[8]||(l[8]=_("h1",{class:"text-2xl font-bold mb-6"},"إدارة المدن",-1)),a(L)(a(B).user.data.role.permissions,"city:create")?(s(),m(a(P),{key:0,class:"mb-6"},{default:e(()=>[t(a(A),null,{default:e(()=>[t(a(j),null,{default:e(()=>[...l[4]||(l[4]=[i("إضافة مدينة جديدة",-1)])]),_:1})]),_:1}),t(a(D),null,{default:e(()=>[_("div",aa,[_("div",null,[l[5]||(l[5]=_("label",{class:"mb-1 block"},"اسم المدينة",-1)),t(a(h),{modelValue:o.value.city_name,"onUpdate:modelValue":l[0]||(l[0]=n=>o.value.city_name=n),placeholder:"مثال: المعادي"},null,8,["modelValue"])]),_("div",null,[l[6]||(l[6]=_("label",{class:"mb-1 block"},"الفرع",-1)),t(a(U),{modelValue:o.value.branch_id,"onUpdate:modelValue":l[1]||(l[1]=n=>o.value.branch_id=n)},{default:e(()=>[t(a(E),null,{default:e(()=>[t(a(S),{placeholder:"اختر الفرع"})]),_:1}),t(a(F),null,{default:e(()=>[(s(!0),r(b,null,w(p.value,n=>(s(),m(a(M),{key:n.branch_id,value:n.branch_id},{default:e(()=>[i(v(n.branch_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])])]),t(a($),{class:"mt-4",onClick:q},{default:e(()=>[...l[7]||(l[7]=[i("إضافة المدينة",-1)])]),_:1})]),_:1})]),_:1})):N("",!0)]),t(a(P),{class:"m-4"},{default:e(()=>[t(a(A),null,{default:e(()=>[t(a(j),null,{default:e(()=>[...l[9]||(l[9]=[i("قائمة المدن",-1)])]),_:1})]),_:1}),t(a(D),null,{default:e(()=>[t(a(W),null,{default:e(()=>[t(a(X),null,{default:e(()=>[t(a(I),null,{default:e(()=>[t(a(V),null,{default:e(()=>[...l[10]||(l[10]=[i("رقم",-1)])]),_:1}),t(a(V),null,{default:e(()=>[...l[11]||(l[11]=[i("اسم المدينة",-1)])]),_:1}),t(a(V),null,{default:e(()=>[...l[12]||(l[12]=[i("الفرع",-1)])]),_:1}),t(a(V),null,{default:e(()=>[...l[13]||(l[13]=[i("الإجراءات",-1)])]),_:1})]),_:1})]),_:1}),t(a(Y),null,{default:e(()=>[(s(!0),r(b,null,w(x.value,n=>(s(),m(a(I),{key:n.city_id},{default:e(()=>[t(a(C),null,{default:e(()=>[i(v(n.city_id),1)]),_:2},1024),t(a(C),null,{default:e(()=>[f.value===n.city_id?(s(),m(a(h),{key:0,modelValue:c.value.city_name,"onUpdate:modelValue":l[2]||(l[2]=d=>c.value.city_name=d),class:"w-40"},null,8,["modelValue"])):(s(),r("span",la,v(n.city_name),1))]),_:2},1024),t(a(C),null,{default:e(()=>[f.value===n.city_id?(s(),m(a(U),{key:0,modelValue:c.value.branch_id,"onUpdate:modelValue":l[3]||(l[3]=d=>c.value.branch_id=d)},{default:e(()=>[t(a(E),{class:"w-40"},{default:e(()=>[t(a(S))]),_:1}),t(a(F),null,{default:e(()=>[(s(!0),r(b,null,w(p.value,d=>(s(),m(a(M),{key:d.branch_id,value:d.branch_id},{default:e(()=>[i(v(d.branch_name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])):(s(),r("span",ea,v(J(n.branch_id)),1))]),_:2},1024),t(a(C),null,{default:e(()=>[f.value===n.city_id?(s(),r("div",ta,[t(a($),{variant:"default",onClick:d=>H(n.city_id)},{default:e(()=>[...l[14]||(l[14]=[i(" حفظ ",-1)])]),_:1},8,["onClick"]),t(a($),{variant:"secondary",onClick:G},{default:e(()=>[...l[15]||(l[15]=[i(" إلغاء ",-1)])]),_:1})])):(s(),r("div",na,[a(L)(a(B).user.data.role.permissions,"city:edit")?(s(),m(a($),{key:0,variant:"outline",onClick:d=>z(n)},{default:e(()=>[...l[16]||(l[16]=[i(" تعديل ",-1)])]),_:1},8,["onClick"])):N("",!0)]))]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})],64))}});export{$a as default};
